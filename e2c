#!/bin/bash

declare -r e2c_version="0.2.18"
declare -r e2c_os="$(uname -s | awk '{print tolower($0)}')"
declare -r e2c_global_dir="$(echo ~/.e2c)"
declare e2c_loading_pid=

e2c_logo() {
    local logo='
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #########         #####         #######
                  #######    ####(  ###    ####    ######
                  #######    #########    #####    ######
                  ########       #####   **      .#######
                  ///////////       //        ///////////
                  ///////////////    /    ///////////////
                  ///////  .////    ///    .////  ///////
                  ///////          /////          *//////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
    '

    echo -e "\033[1;33m$logo
                                Emma2click
                              Docker Magento
                          environment and toolset
                                  v$e2c_version
\033[0m"
}

e2c_loading() {
    tput civis
    e2c_start_spinner &
    e2c_loading_pid=$!
    sleep 0.1
}

e2c_start_spinner() {
    local sp=('⠋' '⠙' '⠹' '⠸' '⠼' '⠴' '⠦' '⠧' '⠇' '⠏')
    #local sp=('/' '—' '\' '|')
    #local sp=('◐' '◓' '◑' '◒')
    #local sp=('◢' '◣' '◤' '◥')

    printf "\033[1;33m"

    while [[ "$(ps a | awk '{print $1}' | grep $$)" ]]; do
        for i in "${sp[@]}"; do
            echo -en "\b$i"
            sleep 0.1
        done
    done
}

e2c_stop_spinner() {
    if [[ -n ${e2c_loading_pid} ]]; then
        kill ${e2c_loading_pid}
        wait ${e2c_loading_pid} >/dev/null 2>&1
        e2c_loading_pid=
    fi

    printf "\b\033[0m"
}

e2c_trim() {
    local var="$*"
    var="${var#"${var%%[![:space:]]*}"}"
    var="${var%"${var##*[![:space:]]}"}"
    echo -n "$var"
}

e2c_msg() {
    echo -en "\033[0;32m$@\033[0m"
}

e2c_info() {
    echo -en "\033[0;33m$@\033[0m"
}

e2c_info_bold() {
    echo -en "\033[1;33m$@\033[0m"
}

e2c_error() {
    echo -en "\033[0;31m$@\033[0m"
}

e2c_error_bold() {
    echo -en "\033[1;31m$@\033[0m"
}

e2c_result() {
    local res=$1 \
        noexit=$2 \
        error

    e2c_stop_spinner >/dev/null 2>&1
    tput cnorm

    if [[ $1 -eq 0 ]]; then
        e2c_info_bold "\b✔\n"
    else
        e2c_error_bold "\b✘\n"

        if [[ -f "$e2c_log" ]]; then
            error="$(echo $(cat "$e2c_log"))"
            [[ -n ${error} ]] && e2c_error "$error\n"
        fi

        [[ -z ${noexit} ]] && exit 1
    fi
}

e2c_ask_bool() {
    local message=$(e2c_msg "$1") \
    only_y=$2 \
    opts \
    res

    tput cnorm
    stty echo

    if [[ -z ${only_y} ]]; then
        opts="[Y/n]"
    else
        opts="[Y]"
    fi

    while :; do
        read -n 1 -srp "$(e2c_msg "$message $(e2c_info_bold "$opts")") " res
        e2c_erase_current_line
        if [[ "$res" == "Y" || "$res" == "y" ]]; then
            e2c_msg "$message $(e2c_info_bold "[$res]")\n"
            res=1
            break
        elif [[ -z ${only_y} ]] && [[ "$res" == "N" || "$res" == "n" ]]; then
            e2c_msg "$message $(e2c_info_bold "[$res]")\n"
            res=
            break
        fi
    done

    e2c_res=${res}

    stty -echo
    tput civis
}

e2c_ask_text() {
    local message=$1 \
        default=$2 \
        error=$3 \
        error_info=$4 \
        validate=$5 \
        validate_value=() \
        res valid error_count res_count valid=1

    shift
    shift
    shift
    shift
    shift

    validate_value=("$@")

    tput cnorm
    stty echo

    temp_term=${TERM}
    TERM=vt100

    while [[ -z ${res} || -z ${valid} ]]; do
        valid=
        error_count=0

        exec 5>&1

        message=$(e2c_msg "$message")

        if [[ -n ${default} ]]; then
            echo -e "$message $(e2c_info_bold "[$default]")"
        else
            echo -e "$message"
        fi

        if [[ -n ${res} && -z ${valid} ]]; then
            error_count="$(echo -en "$(
                e2c_error "$(printf "$error" "$res")\n"
                [[ -n ${error_info} ]] && e2c_error "$error_info"
            )" | tee >(cat - >&5))"
            error_count="$(echo -en "$error_count" | awk 'END { print NR }')"
        fi

        res="$(read -er 2>&1 | tee >(cat - >&5) | tr -d '\r')"
        res_count=$(echo "$res" | awk 'END { print NR }')

        [[ ${error_count} -eq 0 ]] && ((res_count++))

        while IFS= read line; do
            res="$line"
        done < <(printf '%s\n' "$res")

        e2c_erase_prev_lines $(((res_count + error_count)))

        res=$(e2c_trim "$res" | tr -dc '[:print:]')

        if [[ -z ${res} ]]; then
            res="$default"
        fi

        if ${validate} "$res" "${validate_value[@]}"; then
            valid=1
            e2c_res="$res"
        fi
    done

    TERM=${temp_term}

    exec 5>&-

    echo -e "$message $(e2c_info_bold "[$res]")"

    stty -echo
    tput civis
}

e2c_erase_current_line() {
    echo -ne "\033[999D\033[K\033[999D"
}

e2c_erase_prev_lines() {
    local count=${1:-1}

    while ((count > 0)); do
        tput cuu 1 && tput el
        ((count--))
    done
}

e2c_in_array() {
    local entry match="$1"
    shift
    for entry; do
        [[ "$entry" == "$match" ]] && return 0
    done
    return 1
}

e2c_requirements() {
    local test pass=1

    e2c_info_bold "\n[Checking requirements]\n\n"

    e2c_msg "OS compatibility check.................................................  "
    e2c_loading

    case ${e2c_os} in
    darwin | linux)
        e2c_result 0
        ;;
    *)
        echo "Currently we are not supporting $e2c_os based OS yet." >"$e2c_log"
        e2c_result 1 1
        pass=0
        ;;
    esac

    e2c_msg "Docker installation check..............................................  "
    e2c_loading
    hash docker 2>/dev/null
    test=$?

    [[ "$test" == "1" ]] && echo "Docker command line interface was not found." >"$e2c_log"

    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    e2c_msg "Docker-compose installation check......................................  "
    e2c_loading
    hash docker-compose 2>/dev/null
    test=$?

    [[ "$test" == "1" ]] && echo "Docker-compose command line interface was not found." >"$e2c_log"

    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    test=0
    e2c_msg "Ports 80 and 443 availability check....................................  "
    e2c_loading

    if [[ -z "$(docker ps \
        --filter "label=com.docker.compose.project=e2c" \
        --filter "label=com.docker.compose.service=traefik" \
        -q)" ]]; then
        if lsof -PiTCP:80 -sTCP:LISTEN -t >/dev/null 2>&1; then
            echo "Port 80 is already used by some other service." >"$e2c_log"
            test=1
        fi

        if lsof -PiTCP:443 -sTCP:LISTEN -t >/dev/null 2>&1; then
            echo "Port 443 is already used by some other service." >"$e2c_log"
            test=1
        fi
    fi
    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    if [[ ${pass} -eq 0 ]]; then
        exit 1
    fi
}

e2c_install() {
    local archive test

    e2c_info_bold "\n[Installing commands]\n\n"

    e2c_msg "Locating archive.......................................................  "
    e2c_loading
    archive=$(awk '/^__ARCHIVED__/ {print NR + 1; exit 0; }' "${0}")
    test=$?
    e2c_result ${test}

    e2c_msg "Extracting data........................................................  "
    e2c_loading 2
    tail -n+${archive} "${0}" | tar -xzp -C ~ && >"$e2c_log" 2>&1
    test=$?
    if [[ "$test" == "0" ]]; then
        ln -sf "$e2c_global_dir"/bin/e2c /usr/local/bin/e2c
        if [[ ! -f "$e2c_global_dir"/ssl/config/v3_ext.conf ]]; then
            mv "$e2c_global_dir"/ssl/config/v3_ext.blank.conf "$e2c_global_dir"/ssl/config/v3_ext.conf
        else
            rm -f "$e2c_global_dir"/ssl/config/v3_ext.blank.conf
        fi
    fi
    e2c_result ${test}

    case ${e2c_os} in
    darwin)
        if [[ ! -f "$e2c_global_dir"/mutagen/mutagen || "$(echo "$("$e2c_global_dir"/mutagen/mutagen version)")" != "0.10.0" ]]; then
            e2c_info_bold "\n[Installing Mutagen for docker sync performance]\n\n"
            mkdir -p "$e2c_global_dir"/mutagen >"$e2c_log" 2>&1
            curl -L \
                "https://github.com/mutagen-io/mutagen/releases/download/v0.10.0/mutagen_darwin_amd64_v0.10.0.tar.gz" |
                tar xzf - -o -C "$e2c_global_dir"/mutagen/
            chmod 0755 "$e2c_global_dir"/mutagen/mutagen
        fi
        ;;
    esac

    if [[ ! -f "$e2c_global_dir"/ssl/certs/rootCA.crt ]] || [[ ! -f "$e2c_global_dir"/ssl/private/rootCA.key ]]; then
        e2c_info_bold "\n[Installing CA certificate]\n\n"

        if [[ "$e2c_os" == "darwin" ]]; then
            pass="e2c"
        else
            pass="e2c0"
        fi

        e2c_msg "Generating private key for CA certificate..............................  "
        e2c_loading
        mkdir -p "$e2c_global_dir"/ssl/{certs,crl,new,private,serial} >"$e2c_log" 2>&1 &&
            openssl genrsa -aes256 -passout pass:${pass} -out "$e2c_global_dir"/ssl/private/rootCA.key 4096 >"$e2c_log" 2>&1
        test=$?
        e2c_result ${test}

        e2c_msg "Signing CA certificate.................................................  "
        e2c_loading
        openssl req -new -x509 -nodes -sha256 -days 3650 \
            -passin pass:${pass} -subj "/O=Emma2click/OU=IT/CN=e2c.local" \
            -config "$e2c_global_dir"/ssl/config/rootca.conf \
            -key "$e2c_global_dir"/ssl/private/rootCA.key \
            -out "$e2c_global_dir"/ssl/certs/rootCA.crt >"$e2c_log" 2>&1
        test=$?
        e2c_result ${test}

        e2c_msg "Password is required to trust CA certificate...........................  "
        e2c_loading
        e2c_result 0
        tput cnorm
        while ! sudo -p "$(printf "\033[0mPassword:")$(printf "\033[1;31m%s" " ")" true; do
            exit 1
        done
        tput civis
        e2c_erase_prev_lines 1

        e2c_msg "Trusting root CA certificate ..........................................  "
        e2c_loading
        case "$e2c_os" in
        darwin)
            sudo security delete-certificate -c 'e2c.local' >/dev/null 2>&1
            sudo security add-trusted-cert -d -r trustRoot \
                -k /Library/Keychains/System.keychain "$e2c_global_dir"/ssl/certs/rootCA.crt >"$e2c_log" 2>&1
            test=$?
            ;;
        linux)
            if [[ -d /usr/local/share/ca-certificates ]] && [[ ! -f /usr/local/share/ca-certificates/e2c-root-ca.crt ]]; then
                yes | sudo cp -rf "$e2c_global_dir"/ssl/certs/rootCA.crt \
                    /usr/local/share/ca-certificates/e2c-root-ca.crt >"$e2c_log" 2>&1 &&
                    sudo update-ca-certificates
                test=$?
            elif [[ -d /etc/pki/ca-trust/source/anchors ]] && [[ ! -f /etc/pki/ca-trust/source/anchors/e2c-root-ca.crt ]]; then
                yes | sudo cp -rf "$e2c_global_dir"/ssl/certs/rootCA.crt \
                    /etc/pki/ca-trust/source/anchors/e2c-root-ca.crt >"$e2c_log" 2>&1 &&
                    sudo update-ca-trust && sudo update-ca-trust enable
                test=$?
            else
                echo "Currently we are not supporting $e2c_os based OS yet." >"$e2c_log"
                test=1
            fi
            ;;
        esac
        e2c_result ${test}
    fi
}

e2c_on_exit() {
    e2c_stop_spinner
    stty echo
    tput cnorm
    echo

    if [[ "$(basename "$(test -L "$0" && readlink "$0" || echo "$0")")" != "e2c" ]]; then
        rm -- "$0"
    fi
}

trap e2c_on_exit EXIT

e2c_log="$e2c_global_dir"/log
touch "$e2c_log"

if [[ "$0" != "/usr/local/bin/e2c" ]]; then
    e2c_logo

    if [[ ! -f "$e2c_global_dir"/build ]]; then
        message="Install Emma2click Docker Magento environment and toolset to your system?"
    else
        e2c_is_update=1
        e2c_res="$(e2c --version 2>/dev/null | tr -dc '[:print:]' | sed 's/\[0m\[?12l\[?25h//')"

        if [[ "$e2c_res" == "$e2c_version" ]]; then
            message="Hooray! You have the latest version of Emma2click toolset. Reinstall?"
        else
            message="Emma2click toolset v$e2c_res is found on your system. Update it to v$e2c_version?"
        fi
    fi

    e2c_ask_bool "$(echo -n "$message")"

    if [[ -z ${e2c_res} ]]; then
        exit 0
    fi

    e2c_requirements
    rm -rf "$e2c_global_dir"/{bin,completions,dnsmasq,docker,functions,local,traefik,www,build} >/dev/null 2>&1
    e2c_install
    . "$e2c_global_dir"/functions/e2c
    e2c_sign "e2c.test"
    e2c_global up

    e2c_info_bold "\n[Installation finished]\n\n"
    e2c_msg "Emma2click toolset is successfully installed! \n\nRun \`e2c --help\` command for usage information. \nVisit local https://e2c.test to check useful links to included services.\n\n"

    if [[ -z ${e2c_is_update} ]]; then
        e2c_ask_bool "Initialize new project in the current directory?"

        if [[ -n ${e2c_res} ]]; then
            e2c_init
        fi
    fi
else
    . "$e2c_global_dir"/functions/e2c
    declare -r e2c_project_dir="$(e2c_get_project_dir)"
    e2c_log="$e2c_project_dir"/.e2c/log
    e2c_load_project_env

    case "$1" in
    global)
        shift
        e2c_log="$e2c_global_dir"/log
        e2c_global $@
        ;;
    init)
        shift
        e2c_init $@
        ;;
    sign)
        shift
        e2c_sign $@
        ;;
    --version)
        echo -n "$e2c_version"
        ;;
    --help)
        e2c_help
        ;;
    *)
        case "$1" in
        up)
            e2c_local_project_check_dir
            e2c_local $@
            ;;
        add | down | logs | info | remove | restart | start | status | stop | update)
            e2c_local_project_check
            e2c_local $@
            ;;
        bash | cli | composer | db | grunt | magento | m | magerun | mr | mutagen | node | npm | pull | push | redis | share | sync | varnish | urn)
            e2c_local_active_project_check

            e2c_res=$1
            shift

            if [[ "$e2c_res" == "m" ]]; then
                e2c_res="magento"
            elif [[ "$e2c_res" == "mr" ]]; then
                e2c_res="magerun"
            fi

            [[ $(type -t e2c_${e2c_res}) == "function" ]] && e2c_${e2c_res} $@
            ;;
        *)
            if [[ "$1" != "" ]]; then
                e2c_error "Unknown argument \`$@\`. Run \`e2c --help\` for usage information.\n"
                exit 1
            else
                e2c_help
            fi
            ;;
        esac
        ;;
    esac
fi


exit 0

__ARCHIVED__
 p] rG(8[_,A̺@E	A	Ӽ5@@ͪRf@y:{v=f؇]udDfd] Qypw֠j4.^~k^鶛lZ/IŀQ8/IɎfPOѧۿm6.ja4xǟoNsyqQo7{wV.jH+ݵm\h}B
k۸ 04<o7]i0~2NgV^gPʮoo|nyQOc?
*
~'o0{/_oܵm\F_w5ou{7[`G<aS&؀}o~:~N5X3/<gQzǕ/Q0c?Mi?>ј'ABiX&)\K|v>! )H4P<w+a"+q{MOF^~.=6&f!GL_K/:n3n@(`pBD" Yxݗׄ9|2:OFP@8$DI
t`n'c4\g!í:%7[J7/~4ny}j[7;a:ozoR}W*.YusQ7.:Ag1/?1!Hxw^h⦣_݁Q0ӽ^P&	B,×I;ӪH?/$)p˘[&Lkt8hKN*s~e+Gѡ7:zɠ?@M]vp1gշvMvs
dR!n0FS,q$,R>qy0:G cޣAʚR!b^ȶjmUY6|j%i0H|/yzGCEQeoEo{JK K 9]]dLL{A:Er*&ڄY@	d@	d{Q̠Bao:
qL/fk5J$q+kaZ^ǜ#V]RmOF*g6cya(j0嬻.{Tp:֣?4=WE	?S'%.9Wt:}pB^k"9*/!C6L#HW"i4!'~.qOpҊ"oxURX;ԣQO5O(Nދ~urՏE,v`%ǟM:LRx[y0胎t.KQ⻢>V].'Q#/4/>NO(,"^گ~8,d"l w./5{%6YAMl{.Ȝz`j1P/+MBdKkUzku</:j{K-Q۷nkKVkVVtM*ڗ|c<Wm>a̩; $8J'ƥpHGзK)<YUew
(ylq!j6GYJƣ,[	+2ۃw5	j__IjmܲJ̇odGMBpQ;O_nlml^rY;!1B53=`DB>;h&~(:s~x~N20s:,1U)| h5dT|[v.̶5J(J
hŕo2OM8>O~ڧZ]܀A4I>#52mD*7w"m_᜼iAG$
a/Rgt	dͷa5(BUE *hu=UHLenħCeX	]MߦU#[[	׬Yc_.AjJg&(A^TEE2?H)JbVp?)-Ǧu8'gW"̬oD4kkЅYἙ3%賭vz!4&&:ׇ} eIv2/3/ߗVaow )xw?{< ;(e͹բ?lw_=0~)R
F<\EY}9c?)-P6e:m)3M&p9SM@kTv2`&'*C1'+k] F5|,UEbΫcPW`g8*89FA"/4Γh{~89"!?};<g41۟Y؍qPRN{	;cN܌hx_Tk5;vTYNt214d8^ؘ}lN2D׿j⃃GB<s!c315,WIyT&{lN|֙aUhB@uE?*s&/c[1Ŵd$еC)9!-[y8O~g-(jk>r_:HG2j>F!ov	4J|К=JwoC} E w[.{P}L	㌃_!-s~aǿoL%d^8 4&;bZK ʜ<43аo=zC=~~)$09t|<}WzU_-l\]d	t>7(8zEfY7E[J$b31k崖q:h<s?'`Nke^_HzP%ixLb#m{9TBr텸6-πq'8
p={oS<H@ާ\k̈Zd틬IPMpX*$ΕcE~ox讬j	'?~(ǿj>戱aƈ߳&!#lǾJ/홖?LCEʪ&{!(h/q"۟6vIUf5>@VSl1}̋dU첽i(}&}7M2l,ܞJ((Y++UT=L{AF-,u[YgB`@F܊5Auy#cox陶EZ>^^HtWM$ė_[YIVԖ4\BR쩊=5i ĤI؅(vR~p9"-K_=y:80 Ϲub9[XEz41LisO!3Ͳl_˭RXOP϶6ZNag{Ԩ0g `t*N"T}`tbks	Wd I.|߮t&w^@נ$&Q%N[󐗢EF݅$,ϰ45Kb(ZWf%/l_H[.`YoSJ<&t#hKMKx|8/AB˹Pk$ܲDk׫ՊKV͏
s irPT8)Dj	THaJ҈_K̷L5
VR3z%-DjIُOS%e>MeC*~G%⩫:䦎JdJib]U+kb`kA5;mg@䊦O0)d641v~r:dڀߜ
V瞏GU0s;?@Q^fabi B;cs;amU]wܒ&@x3Vjc1_xu;KeQۺRg&u#rPVT\&269e]\YC:zMSj9u4~'zN<ez|5ɏV~ s<f_-S2TN,aYL"VSǗo\^M%}ZB:^aWI=W,?8׿aRdE:[6eٿl-IVFy^PWUXGjj}{:9Ͻ82Y79֐&ߴ^^s6Ű^:]@ug5IVFcrK߂`G`ʄ|}4@Z7RoשN#J=NNˑ^N$)YO$o_/'s۸f	-BX\rCRbeC鸥	2e,w#H2XϻEyWGXYBX,ңWJB*~^NP:OKQ"$QˣLeTZL,)u3^V1qLޙ{')Lt~ g+MX&I}q\4y׋y1RP<Lw&NX4d"~ђ$5_'hЍ,ĭOy 	;7'>6'Ը?EӿаN9ظ)<$,B=j)tUtl-s346~JP=Q6-,Tpvc<d@C p6xVɂ?t3ϒ)4=8mv^C\Pf^'~f6-?&:WFLڌ*o:qsQx_,&ȱK΁ߚFQe]l/8E4E~ji9S!_s9)2Y+g eY~*i0{]{Sv7U*(H+Zsm0vo3"NI<fьEnnV
@(>Q|7ddlZ 㣢Sai"=#z3tovP9]Z$UGV+xrKg60ryވ1iоO#7
vz	#H2M LV|%ks)A<,o밬qKxXn0ξ@Bkr鞖_b$%<\ZaZ1@QOf@|$b-`|`!Sr֧'/m
'_5 iբ5ًۙPA)yo&R{ُHn晈'0J/Ak\s~hcOpun0=뾷j?݄::&c>a<Z,|W[@tV,E2'`,ƷS/^'xjŵ\YTqsr}90tL${o9)L45ki*Pc59}U	ryh!x&_KpF/?g%`ӣ f3D28c<>	6ЦizM̼P,MftLL!yP<z:! ȱZ0[:W΂$8"gBpG\-q|N,^vRw_qs+4G|k22jAჀX+Hku)'}g:Ƀ4ۅZ"X˪,a(U:XgURd[kΐ%Yxkςaƞv2q#&AHߔ$֖SwJ/G:rSl*L|=K̀J"tU
aWhP7 8ֺ>>eLcaY枽lcj.Ė9PB4^hL![FT*P_+D&t6r37v4رwBE&(x+"$
QOS3cwS_9IT6mwCbRnhƆʬi69kZvBכz`?]?m?MӠwCΊQH/`"8Su![B15(O4
I8=ڣ!"TK#1gimp-BNXY`P
=nu]".ZЁhɛțiɛ >Rd!Y,A_D!oHD!oH@Rd!Y,A_/@0)&n ݆[Ww=uQwmu*RZ
^Kա  4UfYJҰ'y$ɺh~Tw~`{ȨpKހ11ޑ`Xq@`1̴Mh9W,dSL㑑{4qЇ^*E\>h劉IFM%_뽲,[ꕻ<L,|Нs=γ(S-\'?1uZz$0݃9By u)z!rͳB9dZ$6 VDzuoJ%ƅ!O+4ne'gfV[^J+3Hu⫾~]^Erak7r}"nnio g*>E({G=ڵ
EM$7ϲ}YJ2}\bx2\X]/XnW[ >c(`hM*Uzb^\\qsǶt}Vm!rM}m_yEJܱ-*c"b]\"ܔ]84a	mrza<]3P%̀
K.<5cMZn%Q
l_s^5XQacy"|%-x1Z{
ds7a	ѿɋ+Ea1ZHͱF>̑u{X/J_UJ
-a3_m̠W`|$k:]⫫=ݑ;BFp8 	J^i4zos!f+jQ\MW&Cm^^X]Em;&h'~+>wĞlVDk,@.l7~򳰾ީiol[,zxgurS/ɅFh'+s?Adј^ZByQ4'B6pC	9hը<+a6gN':(ն_d2mIł˫rf杽g=KQtk+j6gvo/klu,nW5IZhAK3 3DԲrX^dؚ_[;\t
G-5-´ 7И^2`4[h[\ȌLؖs"{
[f,`򃾽ƴ|N)72^5KD9BM" s
3Y9)SsMQ+)fl=8``oe/dZq,藏$.8>a<kCQ[JOg9)5١`/(3m+LZPFf/GZ@jNZt+v`L'esO̪eѦ5jm&qctʺbfgxŬtRemL/>[ap­vڙT+|7/DkKs|ec3eUzзV*.,0rͯB_Yn,uj:rS"BR\en4Ze	-uepV#~~pYD9-	ŧ;],_	(;m^eK5IAhYHI%"aB>rv?)GgwT6i|n!HvCET|gS"߭-XgVF
N`H_QtTkJzq^"-q|WSK.>z^l/,_B!+7h|/N'v玮ngw?٢V2DL8[DuB4^"KU\n~)Fn0IAO C՟G$tVou\1Mxx33ΑZ_iOOo~k,/zWc%Y^nӋg#n̏q/Ov_Qq͚Wek! tVyl;<yyT":G1keag:)p%h|`:WvvNAjsbE6Mp{ar@MX;U]L5M?n՛"`0@nTxxpUiC|=<Zh<D+cMƊŉ?E`o׎뺧Zw %x|Y Nq.G)~ņu~2rpl|UaUq:S rAY$^Mc2 B"2K'7'| J]uiv9ᾦHފIqqp ƻJ|'i%^/"/|q?YUSxȎaQ]Brߛ_hپɛ8LKarMtF^2( #|<$"Ǣ|K$d+旞2S/^=uY܌6+6[-`60vL`z-^;iu|Ihd2tD{#e杼0G)YZBI7w
	#A a<Uh_/+&$
/NSnjifI,.uXH_e)CJpytI'yhƾnꑛ`ɛG#\pVۖ1VT7JGdП)@55w%mhrVCfOؒOX;MF&_iC+-4鯉{-5[JZHql؛cVE`3pddm#`HΩ.)ʈ!ަoӢ[[	׬Yc_.dj ~O;]kL$ MU5tutY@U!g+[2B[#^#d3e"?VI7LP)sQM+8լbfDPУJt"]_Ce9%0)k=]Za1wmV>T'U,.EUC١1ir{q)u3B̭)eV2Җmx}VUV*
;[r_.nR8]\PxZUl_W)Vnq)6oe],-sX50EAK5"dw9פ7rZʦpnTw1NuGvƖlJvTh(Zq{e+M^\fɲ7:?7`PV*?	gCztg?W`//vń"^X3z7248(cZ,ñ
id](+%T-|h^F/>jno!]۟Wov)NN?M,8Ùo=RCg 	h15\ą~pl{	0$8hLqp8-x"=UPJ vHhp'3r~dj7H"aճTtCɹx\58$;m-&waci1[rCN.HpGr0_rn֠~df͌.6J[F&ʓVSSu
8 9;[?^<*yTW+ÞHca[&R჈K-C-j=l빖QGʰZT2rMC&aYŜ-e6f:j!DvJ0ҭF<{r8̕ÂaqIBXzŦV8.+W呄=UB*[U[ZR2rbxe!fH2oYLX.(}%{;2D;ҩN2@m1X)$j@	a ̸Qv RӒ|3OF6=\y_a@YwcWٮ"Bh.^wyl,5~7BE23 Hq'CZ</	S۠`/xܳZIVLbˊAP2yq1kmr[H/(DLf"q:H(W?1܄,R:U=NUEҩUfb)ʚU}`x˲%23^M.A+
Tl]f8
 ^6^Pc]0"#$~9EMB_z,ؕ\\,
^9Ps9-88,,Sf/3iY-o$me!-M3ǩ*\QS**飥ak˹>(XLnYkކW-LZxV;K=e/
-ZMcl4ix;,׬ּKÒTZ~,t}lv1D.>L)ze&@KZ`픥Z"*tbuy*㤘,R 7ʹ2:HҔ꺘E]bAhk$S}Ɔ'5kw~)Pq`߽31;k*uPns`s!s*g.NVn2U?J8oan9;V]"mxŻ	O2Eޤ=euqaږ`"1*[S6[03TMvx-wV㋈űB̊n@6+Rm8cN	D+MT׃7\.תeComMl;jaSش\[ƭk waZYǍ6ܔBVY_QLlQOVD:$;#o9R# ڈ 2öb
p? Mϴ0(K[gsFY23Uۦʍue5c3ф#$-wTT \7	tfSzgnԧu˱y$lwmD/+8Hz2KZ	8rP&im>i]abN6p%JAr[Q O洮:8|wJ+rD7O7Mf*~G茛3s4#qNѼqVąH+keWUƘxhc.@Y tFYZsd75,&E1ǏK71_ݥ'#Ux,I=+(rpP5ƥHgHofL'FF^Bb5_չ̷?YUG荙_>ۤdb潙;}%<'c-*sQ6fam,FWE\ùe8g$%(:j7TuǏ䠀|}5jdu}J9;v,NuZT;Vә͍Ƀų>֠G&WymaρM<e-Ff\tq!pcښ 3\Kv\ˀn&<(YJBRM\Z(27?'+5-#2U@5̠mgfrMq"z+y3y\y}\'
*Bw͞qUNILS(Vm6[h~z=|7(s}?AGY6YC98GzY)j∗v^6;um}!x((w98R<Gsz51s})YdƗP1^XkkWTmu|(Щ* H<`ʳq=L۟%N,(Qpa
#{-Ks*/TJ\	ME<$1*G-|dv5?
Mݧy.')p\EoK--R*)*zxXRoitdGJ.*a@sP	k<.,9*>[x(7-/V UtijSl4LFN&~GJ>k/[\38bt=Q	B. 7z9:ZoӘbXu߬]ݵgBAF[~T55/դjuqlp@;UnH"Q\$E9ėL%N=o	t<&!jʣ9W'elBnppkBf#`a1
c>jhNX0'34O=;F'7kťJѸ/&|RG}R$nޟ'ɽx>fƒB>L4(w賄9v2*0eMB6GDUЪInU _Py](xׯ+xxwogՋE#6孮سTlA'	,+N#<tۈO_^a@vҎnyM_$Y6*\[hqYQڐnp)et2O'9,^Gp[9E^(ĴpN#>e!fEfh~k6qS|^~+v0H+-OEGŘ ΀U L%2یr%fkWb^eǅYj4q<>\-8'|y>qS6֕o ".ily ӯOApY=?yPdoC}'Y~Eߪ$M= #3rNpnaP񀶽\
GCC藏=!
}A}OnCG\̡W	!6;vAInvD4!ޱ.Ogfjo<ĒMtweN Rx4d;Tty':ܬ@mkrc脙f\w7W,7+ ^7n-?#H*RONɕ	FԺ /=>|]ٌDA)S`q̭kwHa7(JĈcxpU76K'A99Zdd(%hg(s(r^1һiQ=5\n9^Ң.l\e:w鹊/5ַR*:QW2HB-.xz7W"%di{>c]T`̬5^3pHMvj,dN3]& W%2\}b6<^?ћy{$1u0?Fr"3%k9t+ k Ir(q@R@vq̪vcz%W5bϹ!X&V5Ĭ3j,>㪆$H%Z73ǈ	֌fp
.lb0:bEl8h8S)K'[qV\pKtYDlf %ZB>@2^"Nf'X6oK>Eʶ('bOck-VxM
م7HL.vHzEPhq/˭AokO\ /z;3"AQܚicP0JseJ{f,VB07<֪vH03/<'x`&KQes'E䱋hx8z_ ozJ|U}F0Н?akͻ"Z5_dYW!S	rXDϑri`|TNco8c$۶lU<XXeN'1g@\<+׎):&7bA1v.v5X=Q2jA?9OOI/^\}_!Sqr7"ДQٻGh@F65Y,P`L`toI>p8؞</K?M  ΐTZŮ/L奮aLg,Р1z^qFO}Mݒ)
6G }NzA7<WIH=	BS=1lk(
ՇS/|`~O^<M|sL79_ Dxߟx { 'q4$!i]sÇ\Q91TKgAAz2=c @ҋ<9S(6yKo8%ޱ7\938ٵ0lu`htQMH3E*;OtJ5}QI{P)|X4=a[c?/
?zbg7w!>rU$8s'NFbtbKMc jO(=@y|d4	"JL~9uIzY}|jU[yɳk<Z5VGyi\GlyB'xkB,A6@D1Jy*8X1*7Κ}_Īg'Vc}fmm VihzS6A;>s[;+_#<t>eJ12ݯbOBbASsż
BPX.u_oYZj1tbZbi`a$L1VwS\8Q	s	4˘LªgZQ0x_-H	Р|K6I~_\ǫ u'^SUvaMpHvm<0;OXm(pC2R`c\loٛwj(38Ld0wVp?wdA[fbE6Y8_:!@eqMȤ׃$݂gB6>,+yZV{WW}	j(s1(I<8dQf)
-y5g.7#d
-gG˲YX!摂2B=t0ۛZE:MlSfz,V;3R F~XzDZعKӗ՝YF_ܶvv܆-%D'8Z{[E-1X$9hE{(n*o̡:]m+TRӲ %ǣAU*Fu"^<~cgeT A=
>PE,+"D I`jVo6TtCy
qE}=oY2Jp[O-5r=>狇|B+U\(ƍ-jyaU;Va!{(LhwHtGa+%1vg/l=s-֣x#}^k|2A(+ZnGwB"sq^]!kQa1!~zBwT( Ej#IFn6D׾7mg('o
TGފ#o-Y̷J!8v	a/ؙc
mml;0DK:oc_' Gx> 3o2zv<A4B7A|؎	?ax@2鷌 Asτq9ѐWEMCj"RIQʔ1, Sv:gG&CY֬drdDBdrt.ZЅzRY.MIC;9jVO|op谿xOqSh,ԕt%K+[S?6$1^]rp̠dʕEE
|^o	ծ|b"(F{<LXbslDAUKٱ iٰ0Fj)tXࢩw\]Fceobvv;v5V{) thQ;7^ڿܵm\zSOPڿk޵m\X@^S-{h:ƍa0;o7w_#4A*4vMىOl󘾠K8+(1ԡ?EP@0da#p$'tD(*ъ?=ʀiG}^+Y +2G3$F7xOnOsV2"= 1y|uS/	蕰(y琓B:X,_`ūTHI;=jmL$rI"{^+=
Ѿ^嗩I	I{gF|RIHc!=*{F^Q[&9é`gfY%NrCh¦B[^A(A	}:3CdK2{Qt	NL,H
$	orFSPoTμ -؀wUsг a}bo{[|"f
 Jk7.Wd9&Q4fkPʠ
D!j68!!RJ/=HdT@Z[ S_@2^[{nV\-L6p47?0)A|8bS,_1&L >"+K/"p3phrm2K.	ġYpi袼rG@{KeU^eo2!IMs}O>MpHW{D/3XО@'q4|"5K1ɜT{?ǭ/nҭ򊬠1uVeK' ޟBN^' ^LSL$Yq/6_k0'? ۬j5m\bceUnZȀԛL;CE\#ɮ|n7(KaZJv	Ks8#XcY7IFߝ[fαq
1+EkȪxFi۸z8ܜm@9pnѴm2h|Czd7\i$ܱ@r P`xnA}d<]ZqNasyB8nNG립S Jϴ6GmWsf'vݸqF/'ʃb\0ia7a)zA80P'b4+-/!b>`+^E]f˘'۝ZtqrYR_4JEz{0}ݽWGq>@O<0;{+wg@Ȥ/>I8l*[Ow~`{{;Ϸ^}///s'}EgDyŋW4Ym/_W/__Tϻ{^o=תf9IS^emiyvo6ܬvn#-<3(WK|Fn`+0S"\l*߃ ^N5KϚ~9?˷ m=`ƔE؛˃@&<˜`E#eI|V|Ye|GVW02Xaeq v4֛w\s҂q_X[enX?!h(g_m<.@/P58XRCދFǒu_O}1TG#,/	ݖ<,mEۈYK:Bw_<Cc>
d~v.|c/<(K7piԦ[QAԼ7]~KǑHެ}bQx^Pj<Ψ	a,eA
ei<@D^s cq荄)ů8x=pf-;6
S. ȴ`}Z!v֭9~wUOkltWnZPUknl]P=U*ǬJ\D7Te}\{A:C<_vݽq͒\]ГY!67!%.rZfZD5Va>)d|Y=e4uKKt;qnpI˘'ۭ\[
k/H@q+x>ƇBml i"L#gC'oʌNú@ndJx xN_e/MFHJey(7f.s}vwC^g2ffk]nۺ;+{_lVTy?HVUQz8SO~'FU|Jt?¤=7ZF iU%4~,'CyFN7E@C?`e3Q%o?iȸ U {GCONsYY&:`Α7FlQ274d5{npG4A4MQ3cya,9TMVMx0c@h~Ga<4^(i7͗?8>Im_9qMClt:GGb֪8Ӌzrzmep&UtDYG螵(>gcUL}`?h4Vl I4:?!(_ڭVAu~@=QzޑlA4z~#e~zh=67G,@ǚn mσ,f5D:Giރ.oY'B,"M
N [s۱3DםMAH:@*x<@8xAQ ]V엲cziNh&a.̥#fd:2k^N!ƪd-4I%co4	3!:L>w?ݤH IVD1.Ln CBCCq)$C
lŠ;|G{,&B<	05`WK8{" W_B3_@5v 	rh,18}Qt=
y ]	3`F03~uTq'Z}O`2ԭfCcja0Sps8$[ɑR"i6Q_i`B/ݱBFҠLR-_JQO)úPbS6QdjГ߰UI_h)(v^> ]jx@*fUY-;amS{VF!$Ad6W;nfN;۝=w!lvxVhlnD$_/'պVjFs%m,E/j(
jez@g{cIx^)|n#|M#	H"n5;n >v{mv묽B uSsmw6଻덞ou]Nsmu[TtEvvm6֝pPQN85e.k$i@ŷ[|`֩n9 vk]>B,>$jPFiF۠-gy4*.o`s,B5ݚʥ2^QmJ xC=Z=lugRn4:h:D{ĉ sg݁vێF6[9]=4ˠu .-h^,]o \h&|Htqiգler@;vFnJmt#&ḱӃԭ6#z:T(AK>5m__{N*ѢIϿ4֠݃B.luMEAn4 Um Bv uarmu
Ehg&@v11⺧=4'0~GAƅ,/
-d4MAС]+ը.Јv@/It\:02&y̿W-O&|ZKKрBׂ5؃{OOxd 4χ=KlH5ZMΕfpw_Z?B'Tk̳njZ۸{^rR?)sb\Lݪp5=6A'Q)N5StT4jBQtx5!˭ߴ<I00au碃~106c_,vNNM{yNyF?)K0?H/G+c[.mvNny_Rx^ "{jQlˮA*̱@7l\TNg$.Q[b&+"
,ZSqԐBcdI?^GOLTp=oNz'_nJ_oU/4Xu3}.,)_/#[;? %qHg
6Cy`d$ˍ+UxuVVj<l0k(fBHL|j|'s4oW-#|3yt$ZDExi/ѽcbB ʪ}g4p_q7lw_]V/	JOrcA"8ɺ>7x<n}FvIܷ)״#e5+̖ݏ!\e#-_i!5Ȋ&r2Sa+B1k+"32μH՟0J!
Ua8:)-wemZZ콪a.tsTaWWi=k$KCݢQ~(t9OCjMQγ6&i"n}+6b"$90`Aꛟ;Kȯ⛬>0SFu?ke+X@uRLJFA+V],UOUvq8/c8A(5M!96&ȆBCQJ/+79N5d.ͳEWWTJG{ꍂԮLZMA4 ފ;|(]b+]H8@x~x?MFN!~VA*2IU72BeC❬^""Nb[X7c\CX!%	z\NBG4خ(6$IUя/c|2Մ 0GGZh_R)y}{hFO Kt(}|3gR]/0cL"J@)_]Ӳdχ!,
z<~PEUWLކM^ƣI` Wkƨؑ\]sF"ހ٤7߭{V&U]o R^q%>4NVBmwbXMrǥSCtGX5dln:K]dqxt$fzG8bC@y^|誏cn-%1 e^scWE1
m3u2b:nA1-< |}0'{*_C/0.{1VUpŬW&:yJqCl?)oz7JKF2o蜝(etX^(;*zn=ʦ+r,D"~rT+^Ah]6*󉗜Xs0Tu$r%2^S'qj9FYGgg^B<Bs*9"I`hb5*%g#<}e-@*UƵI }	-v:mz[v[58"ohf1v)0.O*_ܯd`W)mAe*؎9/W/7,N7Ow_<gN_n)өH a5sBI4Y@D6IN_Бƻ~żb#,]Ȳ-ɐ0Np=s9q>=J ]NXE*h yA}T
hu՚!$P@cR2}QTR ʶ_'fTc6mS\dʤoҹG!0W?W˽~W9^'4;~>?yt! #/|,Z^</wV]xvV[@|MJ{x5|{n`n_& R.,Qp/ĀѲ-Lʫfgdy$Sm;ғ!oD?0:O9dx.t7Wxr#~D8Rg3
·nx:~{PƇٙ@j¤Zf{1d{i!C*\*q$vUTr{JӰ/!(phz2 rb\G9<$Hs}}P#otY F?0$N<x~8B4SM['
K>ȪۤA8,ŕ2KWG`6m4N<;OXm	f&_Xf_ﾪo?GۥQ#},b-o0f~)"i,E}<'?
B=LkFc,ެrhK\cd8h#IEQ5?a$څצ\>ML-dB8Dn^70CT_8ZjQq?$ĜiQyO؋'Ld c=^\P;^drKkxYPW]U%GA4[FJ}4%"`/	҈6Np,[vP[@k?y n8u_$zYĮHk."݂mұA5/o-VB yŒ3&8ac9ynjd s
LhTr1kT4V
SVjUHco´z}E4N4ˢJEbg9|Dh4yB6r۾*fliw<aC/(oKly>7m>L߂ͷ'jd,etڒ"ˏQ{Oєx(wⳑG$t	l{Θ60ZBGJhDRP+TlL%Sd5/e/Jw*XG.: gGp?PW/'jZVՊ.Q'{EYs` dƆ&NT\n{MCgKNjgSFl1B?7,id_hӡDFmF!.YՖr:/6_a8AiPbqQ|mn3ɅYU[rgSuM_M^^ƪJU[]x9!f:n1_,0?|_B-ٰFMNr1#o--Nj.ڂўNV.^0	8q?:F$$`:Z#XNI}~xZ˥1cP+#·t-N.хw	>Tkug&|L	>EqBt:aYא\=iq9ͬ*e%c*h3ƋB:Rpq-=EY3Wj6\,oldiΩ2|PÈ۟A)NQf[ᄶMk=^C_,5.G>YW~^og<kk_ R;8s&f!QONyFYi?۲|oZGk	FY 0@?ޏfD+Ńs\bLd;S5"vF9
BϪ8$О0(pPE.P(Vߟ?.<)Zl46HeNM~f2rF@/Z|ڞUn`y9AN `rŐ;3tI{Yy̨^fNk5[-aoD\Wc''#HF *[^I=M|λ*cVbf^E2vQ{ҡ&6movp2SJ ;Q6onvy?Hv7&Z3AHN	?)t+Y_o+F̍hMׄ][/*BilT&1Sx
#}<gnxSd0UiOrPP	4=H>U@U*oU^@liU~/$}v_}nί|׌n9۸<R[*ܛR1|T&Eo2i@GTq\SCZ/S pㆤL(T4cF/S3̲dq][dJI~O cZ@T!ڎ ;P4	aP@`D$.~+U&>.f-4aP1Xeh<~sjû
ߌϟsQoT]E2Np?G*߼0Hqqǉp5HvK1^Mx셥Niz!Icw%~@w3F'Z4C'\ Y^AC@쭵oY3^;42JwJ6KTVxl Jõ핞OɆL4iVN3Lۦ=vE ;O#~zzO)(Hux6>fY8d|Lr2}zˤJTL(c¹Bv:H0vZocIS7`yh vy=B2
״˂%'a@T?އ; 1np42>Q1
d|`'$f}@W}+ :{6diԱ59|"<f:#V
Y'/:?eH?dٸ[u$Yl]H5XT-@
]EPHD\H<Gb Yx,чsEJu:"K^sc)CSJu}lEA* fOLb{8oIp<ʘZm5woZH+X*'s>q&zHjy05@E{ww]w٦Z N 