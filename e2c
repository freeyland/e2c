#!/bin/bash

declare -r e2c_version="0.2.18"
declare -r e2c_os="$(uname -s | awk '{print tolower($0)}')"
declare -r e2c_global_dir="$(echo ~/.m2c)"
declare e2c_loading_pid=

e2c_logo() {
    local logo='
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #########         #####         #######
                  #######    ####(  ###    ####    ######
                  #######    #########    #####    ######
                  ########       #####   **      .#######
                  ///////////       //        ///////////
                  ///////////////    /    ///////////////
                  ///////  .////    ///    .////  ///////
                  ///////          /////          *//////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
    '

    echo -e "\033[1;33m$logo
                                Emma2click
                              Docker Magento
                          environment and toolset
                                  v$e2c_version
\033[0m"
}

e2c_loading() {
    tput civis
    e2c_start_spinner &
    e2c_loading_pid=$!
    sleep 0.1
}

e2c_start_spinner() {
    local sp=('⠋' '⠙' '⠹' '⠸' '⠼' '⠴' '⠦' '⠧' '⠇' '⠏')
    #local sp=('/' '—' '\' '|')
    #local sp=('◐' '◓' '◑' '◒')
    #local sp=('◢' '◣' '◤' '◥')

    printf "\033[1;33m"

    while [[ "$(ps a | awk '{print $1}' | grep $$)" ]]; do
        for i in "${sp[@]}"; do
            echo -en "\b$i"
            sleep 0.1
        done
    done
}

e2c_stop_spinner() {
    if [[ -n ${e2c_loading_pid} ]]; then
        kill ${e2c_loading_pid}
        wait ${e2c_loading_pid} >/dev/null 2>&1
        e2c_loading_pid=
    fi

    printf "\b\033[0m"
}

e2c_trim() {
    local var="$*"
    var="${var#"${var%%[![:space:]]*}"}"
    var="${var%"${var##*[![:space:]]}"}"
    echo -n "$var"
}

e2c_msg() {
    echo -en "\033[0;32m$@\033[0m"
}

e2c_info() {
    echo -en "\033[0;33m$@\033[0m"
}

e2c_info_bold() {
    echo -en "\033[1;33m$@\033[0m"
}

e2c_error() {
    echo -en "\033[0;31m$@\033[0m"
}

e2c_error_bold() {
    echo -en "\033[1;31m$@\033[0m"
}

e2c_result() {
    local res=$1 \
        noexit=$2 \
        error

    e2c_stop_spinner >/dev/null 2>&1
    tput cnorm

    if [[ $1 -eq 0 ]]; then
        e2c_info_bold "\b✔\n"
    else
        e2c_error_bold "\b✘\n"

        if [[ -f "$e2c_log" ]]; then
            error="$(echo $(cat "$e2c_log"))"
            [[ -n ${error} ]] && e2c_error "$error\n"
        fi

        [[ -z ${noexit} ]] && exit 1
    fi
}

e2c_ask_bool() {
    local message=$(e2c_msg "$1") \
    only_y=$2 \
    opts \
    res

    tput cnorm
    stty echo

    if [[ -z ${only_y} ]]; then
        opts="[Y/n]"
    else
        opts="[Y]"
    fi

    while :; do
        read -n 1 -srp "$(e2c_msg "$message $(e2c_info_bold "$opts")") " res
        e2c_erase_current_line
        if [[ "$res" == "Y" || "$res" == "y" ]]; then
            e2c_msg "$message $(e2c_info_bold "[$res]")\n"
            res=1
            break
        elif [[ -z ${only_y} ]] && [[ "$res" == "N" || "$res" == "n" ]]; then
            e2c_msg "$message $(e2c_info_bold "[$res]")\n"
            res=
            break
        fi
    done

    e2c_res=${res}

    stty -echo
    tput civis
}

e2c_ask_text() {
    local message=$1 \
        default=$2 \
        error=$3 \
        error_info=$4 \
        validate=$5 \
        validate_value=() \
        res valid error_count res_count valid=1

    shift
    shift
    shift
    shift
    shift

    validate_value=("$@")

    tput cnorm
    stty echo

    temp_term=${TERM}
    TERM=vt100

    while [[ -z ${res} || -z ${valid} ]]; do
        valid=
        error_count=0

        exec 5>&1

        message=$(e2c_msg "$message")

        if [[ -n ${default} ]]; then
            echo -e "$message $(e2c_info_bold "[$default]")"
        else
            echo -e "$message"
        fi

        if [[ -n ${res} && -z ${valid} ]]; then
            error_count="$(echo -en "$(
                e2c_error "$(printf "$error" "$res")\n"
                [[ -n ${error_info} ]] && e2c_error "$error_info"
            )" | tee >(cat - >&5))"
            error_count="$(echo -en "$error_count" | awk 'END { print NR }')"
        fi

        res="$(read -er 2>&1 | tee >(cat - >&5) | tr -d '\r')"
        res_count=$(echo "$res" | awk 'END { print NR }')

        [[ ${error_count} -eq 0 ]] && ((res_count++))

        while IFS= read line; do
            res="$line"
        done < <(printf '%s\n' "$res")

        e2c_erase_prev_lines $(((res_count + error_count)))

        res=$(e2c_trim "$res" | tr -dc '[:print:]')

        if [[ -z ${res} ]]; then
            res="$default"
        fi

        if ${validate} "$res" "${validate_value[@]}"; then
            valid=1
            e2c_res="$res"
        fi
    done

    TERM=${temp_term}

    exec 5>&-

    echo -e "$message $(e2c_info_bold "[$res]")"

    stty -echo
    tput civis
}

e2c_erase_current_line() {
    echo -ne "\033[999D\033[K\033[999D"
}

e2c_erase_prev_lines() {
    local count=${1:-1}

    while ((count > 0)); do
        tput cuu 1 && tput el
        ((count--))
    done
}

e2c_in_array() {
    local entry match="$1"
    shift
    for entry; do
        [[ "$entry" == "$match" ]] && return 0
    done
    return 1
}

e2c_requirements() {
    local test pass=1

    e2c_info_bold "\n[Checking requirements]\n\n"

    e2c_msg "OS compatibility check.................................................  "
    e2c_loading

    case ${e2c_os} in
    darwin | linux)
        e2c_result 0
        ;;
    *)
        echo "Currently we are not supporting $e2c_os based OS yet." >"$e2c_log"
        e2c_result 1 1
        pass=0
        ;;
    esac

    e2c_msg "Docker installation check..............................................  "
    e2c_loading
    hash docker 2>/dev/null
    test=$?

    [[ "$test" == "1" ]] && echo "Docker command line interface was not found." >"$e2c_log"

    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    e2c_msg "Docker-compose installation check......................................  "
    e2c_loading
    hash docker-compose 2>/dev/null
    test=$?

    [[ "$test" == "1" ]] && echo "Docker-compose command line interface was not found." >"$e2c_log"

    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    test=0
    e2c_msg "Ports 80 and 443 availability check....................................  "
    e2c_loading

    if [[ -z "$(docker ps \
        --filter "label=com.docker.compose.project=e2c" \
        --filter "label=com.docker.compose.service=traefik" \
        -q)" ]]; then
        if lsof -PiTCP:80 -sTCP:LISTEN -t >/dev/null 2>&1; then
            echo "Port 80 is already used by some other service." >"$e2c_log"
            test=1
        fi

        if lsof -PiTCP:443 -sTCP:LISTEN -t >/dev/null 2>&1; then
            echo "Port 443 is already used by some other service." >"$e2c_log"
            test=1
        fi
    fi
    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    if [[ ${pass} -eq 0 ]]; then
        exit 1
    fi
}

e2c_install() {
    local archive test

    e2c_info_bold "\n[Installing commands]\n\n"

    e2c_msg "Locating archive.......................................................  "
    e2c_loading
    archive=$(awk '/^__ARCHIVED__/ {print NR + 1; exit 0; }' "${0}")
    test=$?
    e2c_result ${test}

    e2c_msg "Extracting data........................................................  "
    e2c_loading 2
    tail -n+${archive} "${0}" | tar -xzp -C ~ && >"$e2c_log" 2>&1
    test=$?
    if [[ "$test" == "0" ]]; then
        ln -sf "$e2c_global_dir"/bin/e2c /usr/local/bin/e2c
        if [[ ! -f "$e2c_global_dir"/ssl/config/v3_ext.conf ]]; then
            mv "$e2c_global_dir"/ssl/config/v3_ext.blank.conf "$e2c_global_dir"/ssl/config/v3_ext.conf
        else
            rm -f "$e2c_global_dir"/ssl/config/v3_ext.blank.conf
        fi
    fi
    e2c_result ${test}

    case ${e2c_os} in
    darwin)
        if [[ ! -f "$e2c_global_dir"/mutagen/mutagen || "$(echo "$("$e2c_global_dir"/mutagen/mutagen version)")" != "0.10.0" ]]; then
            e2c_info_bold "\n[Installing Mutagen for docker sync performance]\n\n"
            mkdir -p "$e2c_global_dir"/mutagen >"$e2c_log" 2>&1
            curl -L \
                "https://github.com/mutagen-io/mutagen/releases/download/v0.10.0/mutagen_darwin_amd64_v0.10.0.tar.gz" |
                tar xzf - -o -C "$e2c_global_dir"/mutagen/
            chmod 0755 "$e2c_global_dir"/mutagen/mutagen
        fi
        ;;
    esac

    if [[ ! -f "$e2c_global_dir"/ssl/certs/rootCA.crt ]] || [[ ! -f "$e2c_global_dir"/ssl/private/rootCA.key ]]; then
        e2c_info_bold "\n[Installing CA certificate]\n\n"

        if [[ "$e2c_os" == "darwin" ]]; then
            pass="e2c"
        else
            pass="e2c0"
        fi

        e2c_msg "Generating private key for CA certificate..............................  "
        e2c_loading
        mkdir -p "$e2c_global_dir"/ssl/{certs,crl,new,private,serial} >"$e2c_log" 2>&1 &&
            openssl genrsa -aes256 -passout pass:${pass} -out "$e2c_global_dir"/ssl/private/rootCA.key 4096 >"$e2c_log" 2>&1
        test=$?
        e2c_result ${test}

        e2c_msg "Signing CA certificate.................................................  "
        e2c_loading
        openssl req -new -x509 -nodes -sha256 -days 3650 \
            -passin pass:${pass} -subj "/O=Emma2click/OU=IT/CN=e2c.local" \
            -config "$e2c_global_dir"/ssl/config/rootca.conf \
            -key "$e2c_global_dir"/ssl/private/rootCA.key \
            -out "$e2c_global_dir"/ssl/certs/rootCA.crt >"$e2c_log" 2>&1
        test=$?
        e2c_result ${test}

        e2c_msg "Password is required to trust CA certificate...........................  "
        e2c_loading
        e2c_result 0
        tput cnorm
        while ! sudo -p "$(printf "\033[0mPassword:")$(printf "\033[1;31m%s" " ")" true; do
            exit 1
        done
        tput civis
        e2c_erase_prev_lines 1

        e2c_msg "Trusting root CA certificate ..........................................  "
        e2c_loading
        case "$e2c_os" in
        darwin)
            sudo security delete-certificate -c 'e2c.local' >/dev/null 2>&1
            sudo security add-trusted-cert -d -r trustRoot \
                -k /Library/Keychains/System.keychain "$e2c_global_dir"/ssl/certs/rootCA.crt >"$e2c_log" 2>&1
            test=$?
            ;;
        linux)
            if [[ -d /usr/local/share/ca-certificates ]] && [[ ! -f /usr/local/share/ca-certificates/e2c-root-ca.crt ]]; then
                yes | sudo cp -rf "$e2c_global_dir"/ssl/certs/rootCA.crt \
                    /usr/local/share/ca-certificates/e2c-root-ca.crt >"$e2c_log" 2>&1 &&
                    sudo update-ca-certificates
                test=$?
            elif [[ -d /etc/pki/ca-trust/source/anchors ]] && [[ ! -f /etc/pki/ca-trust/source/anchors/e2c-root-ca.crt ]]; then
                yes | sudo cp -rf "$e2c_global_dir"/ssl/certs/rootCA.crt \
                    /etc/pki/ca-trust/source/anchors/e2c-root-ca.crt >"$e2c_log" 2>&1 &&
                    sudo update-ca-trust && sudo update-ca-trust enable
                test=$?
            else
                echo "Currently we are not supporting $e2c_os based OS yet." >"$e2c_log"
                test=1
            fi
            ;;
        esac
        e2c_result ${test}
    fi
}

e2c_on_exit() {
    e2c_stop_spinner
    stty echo
    tput cnorm
    echo

    if [[ "$(basename "$(test -L "$0" && readlink "$0" || echo "$0")")" != "e2c" ]]; then
        rm -- "$0"
    fi
}

trap e2c_on_exit EXIT

e2c_log="$e2c_global_dir"/log
touch "$e2c_log"

if [[ "$0" != "/usr/local/bin/e2c" ]]; then
    e2c_logo

    if [[ ! -f "$e2c_global_dir"/build ]]; then
        message="Install Emma2click Docker Magento environment and toolset to your system?"
    else
        e2c_is_update=1
        e2c_res="$(e2c --version 2>/dev/null | tr -dc '[:print:]' | sed 's/\[0m\[?12l\[?25h//')"

        if [[ "$e2c_res" == "$e2c_version" ]]; then
            message="Hooray! You have the latest version of Emma2click toolset. Reinstall?"
        else
            message="Emma2click toolset v$e2c_res is found on your system. Update it to v$e2c_version?"
        fi
    fi

    e2c_ask_bool "$(echo -n "$message")"

    if [[ -z ${e2c_res} ]]; then
        exit 0
    fi

    e2c_requirements
    rm -rf "$e2c_global_dir"/{bin,completions,dnsmasq,docker,functions,local,traefik,www,build} >/dev/null 2>&1
    e2c_install
    . "$e2c_global_dir"/functions/e2c
    e2c_sign "e2c.test"
    e2c_global up

    e2c_info_bold "\n[Installation finished]\n\n"
    e2c_msg "Emma2click toolset is successfully installed! \n\nRun \`e2c --help\` command for usage information. \nVisit local https://e2c.test to check useful links to included services.\n\n"

    if [[ -z ${e2c_is_update} ]]; then
        e2c_ask_bool "Initialize new project in the current directory?"

        if [[ -n ${e2c_res} ]]; then
            e2c_init
        fi
    fi
else
    . "$e2c_global_dir"/functions/e2c
    declare -r e2c_project_dir="$(e2c_get_project_dir)"
    e2c_log="$e2c_project_dir"/.m2c/log
    e2c_load_project_env

    case "$1" in
    global)
        shift
        e2c_log="$e2c_global_dir"/log
        e2c_global $@
        ;;
    init)
        shift
        e2c_init $@
        ;;
    sign)
        shift
        e2c_sign $@
        ;;
    --version)
        echo -n "$e2c_version"
        ;;
    --help)
        e2c_help
        ;;
    *)
        case "$1" in
        up)
            e2c_local_project_check_dir
            e2c_local $@
            ;;
        add | down | logs | info | remove | restart | start | status | stop | update)
            e2c_local_project_check
            e2c_local $@
            ;;
        bash | cli | composer | db | grunt | magento | m | magerun | mr | mutagen | node | npm | pull | push | redis | share | sync | varnish | urn)
            e2c_local_active_project_check

            e2c_res=$1
            shift

            if [[ "$e2c_res" == "m" ]]; then
                e2c_res="magento"
            elif [[ "$e2c_res" == "mr" ]]; then
                e2c_res="magerun"
            fi

            [[ $(type -t e2c_${e2c_res}) == "function" ]] && e2c_${e2c_res} $@
            ;;
        *)
            if [[ "$1" != "" ]]; then
                e2c_error "Unknown argument \`$@\`. Run \`e2c --help\` for usage information.\n"
                exit 1
            else
                e2c_help
            fi
            ;;
        esac
        ;;
    esac
fi


exit 0

__ARCHIVED__
 ם] r9(د_eLIy答bQTukRI
fheFdEDb;Ogalk_3_K Uͨ38 Q_}Zsu>knm7YZk/z&IŀQ8(َPOm6Aǟvgi5V -5Fo?;;-.w0{QX;o?4BAZnI0|:δooW;k-kχR{Kcp|ɇ{Qsi Wݵ;_K~Ѹxn?
5ug]Zn+{Σ	Drμ0eXz'XE1s'~\C!;4Y&,S?NQXz$a"١?jXDc~F/dt>/WgĂ?D0W+fB` H2 evvOHD Q}l5a@߅¯O|Fh&Tf'Q	ԙp+`No1O7Fcv\lލx7;aogR}_+]̅rXusQKF~?}OXg+tژXyķW0[kip=tefL|$AeViU2QVx_]xr:aį;J?y7=9J%8_'`at`^24QӐDY]~9>gf;!L&K,9&$W\ƈ(cf(T~&'fةArr9mou[UVj-zIߋFUwʬkwvoo6oމ>d@v	d@rTii);t65M	6l6lA],d+a~z0B#'T"֟1Hj|ӫ.jރFxsXuIYw]?<?s^봗:
D Wq}pZ8Vf\%|M0B&b]r2'ީ$t_@0%Er*9UYB0}b#To#_j)`Ǳ?f>~2{+67MHb譒WS?z<J3?8eؾW{/ag?yW6N8J!:`\TwE=XI\}'F_<躏^|0PYEW)y#s_Y+DN\Tv_mqZPby ĶܼL`̩7c[j$\"d"/OQh[^o7zί[?7Hx缯}j<\m^jj߾skp-T[YY9I6Hko/\ć9ƿ|D$'QJx0/-}S$>҆]Jaj@*3%o{O4M@)cr`eur|i^zhm'J&=?w@S;GڹeTą~zKo铜vmqټ( wSbjfz.$&j'Gc'k0XyѪq9ZQwn<Vph5dT|[w.̾5JJ
ťo2O]8:O~Z]܀A4N>#52mD*7[4pN6_ #PvwCld2Fq滰}
 
Z]tOR<S4 %'PwiȺV5kkeȠZME"ȫ
&T$cxɇ*$fs	sX2|lZWI0sr%L{GDfν]Λ	*؀*[>/^>r>aBcqo2 /`p},4_7
?{}iv|?Ȟ?{;Ovg7EދgeF	(Cnl-e[ѓR?,jv8̪$H+%,	/{ٚHi))mS,i1#L7eۨ 2`'*C1'_kb="11pG(Q03\`  d8=S?v(>GS$o,!{3 RȻ*% 3?Y[ͭz_UV#	n9@JgpxIU@!!fw ͕!"V?\2	9 h^5d	ln%)Pi Y:4	LA;,'wB9'C %5gow_m˽'(7O^o}ciPIkч6RrBZ`2zQc<As7i#)pS]fRP_".+?{=qFw󱯐_x}	7!=9Iv0&N{	@;#smg[/~mgٯzÿn={_X:>[NOv{៷rwr)dcbd,AŅ<U>~eN"^7Fl):s?)fb1-ld˸
m4j9ߟ>nVB٬ח,^-V7	[QIlm/ ]JHTQڦ0#nGڳ7=eD>:gG^cAC_d-ȂoZ!+vP&g+|Cwi%Oݯ5PpՌ>挱qʌ'߳&)j lǾJ/3-.>L˪arazX<LyO$*Sċ )6ИM!B:U첽I(}}h՛$0lvnO%뉓(YX*U0neSj|fszW8.w @4d^V4oOh[={˛^/-A_vH}FSbO5SK.APz@,$]8P@5*572L ӡw	?	U91@C2 B6nr^8gKzrkHR/$Ty;m)]yAVxl/Jce鵭`nEVR3=
dTX3~0<AP:PI[0x'W1HM~RMF98AIQ%Ns)lQT4Ȩ;z+KiX*@,G>A-`Dr qJXƄNc}icI	%
[HB|9u͚Ywv4YuWªYa$1cBZLjq5HM2AJ)4bPA+~FS!J~^ҺH-yb穻lP7]=U'Qi8S,	2MU"&]<:&UV{3e#f
YBLp\(mo.
'&YI{>Va:}߉>."N
~ȧef?J,-l^ 7Z8W
KY*;=֕s4;̿FCCXQEsɼڐovѲ\W2Ճeu`3j9us=],2LxTV>5ɗV~ s2g_-S2Tn,aYL"˖SO' M#|b"Z
}2y!q` Fa5窥K7q\"xxVkMYmn)F~%N$Cy^P{w],#uLu\G`hk|oZv/x3s8Y=Wss7"M՜YtͶH01n_X;
S&#,G#vT1ܠD(3 )[L^uL%bB>afOشowpHPEfRbΞ'4YFVu^m4iaϻE}WGXYMCXoaѫa%ޅ!i`|?/'(]KѨ݋L(U-w򂟙882TS3^0<$Ϙ<{gqL'lBaY:ћ
L⮹ y]
1HAvtGaDOB(2h3-I5\2JYܺx)?$a梚:h>tFv=vJ|%at0<d{*NM)l-s3<6~JP=a-*v'#d@C NuJ+dgHxi6; q3Tűeo?;6O~}u 3%TdDջC<RUfTNgb 9kx9[|p(QcTlf|~>dt`)i#@W OsRa'wAʲJUJOaq8rZVԨ nx1hm冶$|!4TsN9AY
@(>QLW:lA"GEŧ0rD:!#PzJ(w Ч*3uriETiYům*/i[fYGC.[Q~Cjg$:C$!MӃrs?bBĹ#H2+!30ъC_|hGx<,1JbFem|[eRj
grqZK%-LãU+9DjuJW"VXg:yJMX)IKhW@lD4(v:evrERTԼ7id`&?Nī1HG >4xƞ.`{6}2	wt/( 	F}$}h8]J|[[@tWݬE0'`.ƷS/^'hrEz.Oݬʹ9۾:H{!^}ǚ5E4(1fþa~Cэ<edg')zŗ\K}Տ8{]	o0;1L5;ϻO7}Mg^&ύ&hf`qS8ttL, yPKzFJNŃ)r,!tS =&);Y}(<ChAQ)2\_]C}=bY$z^	^q.C+c~y7aKFXP52>	(@Z]H)<P=Ӊd.
a𫯕!^T,|dg# WH8?d#\UImm6CX	7j/ab;SYi523U]Rk˾#[J$oru_~9AO+ HCP	^_
X!@8m* 0_5S0X$Cg/[ڗms3ePLں+_pDh,T<H~JKRsޘ&R1L)(ĎTOc!
YDJVYXl
܏@$(D=MIl`tMrѓ$6_m~v7MmwSۍMmi(mr-섮7MctGG4G>6ﺸ/U^EpXkBķXsۅ#t984kPh&h
p0C{4(GCD(FbP/r"D[z\ksU|vgG|`hѲBss˪ҕ_:K[~i/M~CJd
Y@6|C"ߐ7$|C"ߐ7$;|ÕJd
Y@A_Ё0n}koI1s[ok۪Q[RBKk)x-Ն*TYeY*KÞeo%YDoM8Qrt rx6o!A4YJGLF㘶	MwUKdJ%2w&(=8C/_yvE|B!<gOIFMz%o뽲+wyB}9<%*Y@wΝu1ע{*tv!(	kL׭G{;53C8!B/^{DULz<G'68xk~(Hq!x'K pɝB?S-rw%yRX3Dm~{Bʈ."5L>0C77_3_@_"q_sVxpZDSpϲ}YL2}Lbx2\XҮ4,ݰ8,d 70So0<M*Uz޳b^\RŸRٹc[z(ۊ\S`*jd^cmr}%ͭvؖ*Zdk"b]˴winʞ|밄80~]3P%̀
%`QzӚa(\qZY:X*-a	yŊ{橋+FuTi	cS&[	0uY$/
)Wb12X#E~]=鋒+Ja1zzG֤Ÿ(&]m)UZ6Ȁ	HPJsP&1j\s!f+jQ\)2NMڼ]Em;&hv̕bݪϾo}mؓ%Od+7f>y?Z̧-lwڛWZjqLa{R&
P:sx27},潪&<-<L\Е]ju8ǉC|	9&xQyVԏ1lԩ?u^Qt{m~Ybfv<K&]>եTx1]0[DX3?^Yj.k!=e{}\c{juSZNpt0A4N-vV<Z^k2Q,Lsp3Li%ӘZ'Ez'Z{K)R&l=^Qrn=h)fL~ҷ7Xh^Fk`Ci:X r9j dkP@_O[/IkZYۧMb3(Ik}+{.]׊eqG|&q|ʋs(SjҳY=xJMv8{>6gU&OPSѪll6S.݊XuBٚGagoYyjh=mfTt~[SE-pXp 
Pne:hR1[ow^W%Xs/<.gf'f8i-ʪܩI{з^*d昹f7lNӮ/q,7@5rglqt@9b-櫼`,PW6	q/OE˘@Y|
>Eae_
Od@P~bY.Pޟ$i4rŐDHU.-̅j?}$.]4S=B9glƣUtֺY'"I;Syq 2cqMc[A(8M!~*F8֜7,FyVi[>9gP\0@}9^hAIYBHWn^8[WЇ՝]wŵ00G6EHfJO8[rDuBQ"KU\nޔ?gYۣ=)(eC`s`蒄-dU(HݔNm:3^՟w.JB7;{%^EP?{b/z]?!Q'i|two5RhhUGׯ;ir- ,TgQ4p R'Zg/Z7{{;/Hk_>/Jj 9cD7iua=@TqXj~ݒ=7Edlǁ^
|/6dӎxy{xѺy<H^ǰ 8tI]]uOew %x>ܬPe?W|!Ax~ЮOAYә4G BL#h(zӑ hk0 )h`|i|<7
y[{vly+׏`.b/f;).k6xeluTM!eEu:
1˽o~5(VD&o,ŉN7ylY䂌PΒ-Γ{¯Ls|_z:P{Oyx56 Ws3ltQ7Ǳ٭koל^>>I&KG'9bPkm+sDeX9T\ts0L0TB?1A+}Q1)L|_(TLznB5ٚ2a"}I`:` zn 2N ;FRhGn-5ofm-bũ)JGdЛ)@5pϹ}I}y649_|E% dcN'qӼɍ1Mq)`%ݜ&u/;KͿWAoCTu-}"@яlػc#
|#&ka O䜚LJ].-XYa+K{55"O6XF{
R7iri	{St&&a">$q}PjUHʖk22RqiI7LP&)s~2mj}1cD'P0Jt$]_Cc%0)=_Za1wm|M)Y]<_0M5LŴ1''n2Y?FSu5̶nڲm3 tlUelePQ	\ܤ q<b،_WVnq̨68Ym[X5DIKu"t4sKorZ)Tw1NuGvʖlJvT(`m=âG^\+.g}~ ghb w@Sp5WNWoqVK56␙O(3	bv`La: طS|U4.ꔥ^^e4/#>knoo!]ػ~v)NNw?MNpp\3	{RCgڔ 	h15\ąq#K+` +H2p_шp`8[{w3hTqB9!Vcf ]`t.^dIū5ڧx%Dog4;Kْsavv@"=hm=Ճ^,s5ch4pG]Pr04aVZS>ZlDQP8WJ]GcyNmHͅ"zF]u+jR
96a(Hgs1Q!BL(o}踘wOqrXp<,`3	!^ʵCy$ar\uv~悥yԭܬ8^YH![|pK>v_k^ÎѮtZVf
!%$F~ӥsG$ 3nd}(&ǔ_qѝù:&?G=vY,<Bsc{da=+tRt,@7\<!anl{V+)YlE1(_Y
W9a7?"]8ym~p<RuKE ӛI\ƽ9aCVǁ89/p!cǫh7y*T.NUSUtjXJ)2Uj9X%1^lLd|Aq C{*TOW.JQ] Q/x]/.DW]pBy"m[hUKs%sc<܉`댖yXj)t
V٬wfY?sq
WԔJhi"|>!rn95;[ .%aUӳ>9k|piUE\+ҳkoEmњ;{XJOř6oXMHUް^ٗSE!̤hkTkGE.O%by*rnNS<J|CmOH׮ 5N)bՓZ	;CrvT0xޙVG5(k}k?s`s!K3&8]h=yN>E3^3ݬkzEXϾ,r߆W`4-|\MܳPVWm+~O.`n['f43v:|-;f/q#bq.>;Azvs~gn7 |68N&D+MTx׃7].֫eSooM;aSܴX[¤waVYo6ܔv!dx,&Z6'+"]ݑ\NPmD 2˶b
r?ˏi!niP4(KefL|[+Mӕe<>Q?M?dSFK7UAUp>HUk/}mx.AՍԻn=6O{MrvF䪞zoj$.D!uK+I>hC 늓h\*t~&DVI<_ZNSG k9Ug6~)Qk,Wt3}___j*qdV;Bgos捳2LGdF7GZ*:wN0WO_	@x(Ukz̗Wf8Ytd-t'w%//0ܥO./3&FAdNK{jXN Q.75\[UrRw׹ww?YVW</-jc|I{3wJxG[UglTa6čua҆s#Kq}EK8Q DoZOAs}5ju,|ǔr"<Y8Ii)FPܱZLnnN,f)Mx^qDط	?2,ϗ9+gᢋ,vX6ث
;r-q-fQ(%$SM\Z(27?'|(5-#2$+of6g6ԛy8Vf8&7
*Bw͞qUNMMub9b6٫EDO&ӆ2}{'9#c;kbx)G^!TO#<AM@\f7OؼuN'GQW`x.;ӗJ59;zU`pv3#@9[U@בyg3?zڝw?K<%0(Qpn
C{-*%Z¬}S&a	"dLF>td]͏e0ӼWDSnqku.ۢ7wKi/)TOsU=8,ZUR3#l5*qug@%qq3 @1HqK+UOihfљ>x5$ϥCքY[\?bt=	Q	J JBR2o~dV4fdtA>]<7mFwY<|O~,T55/դjTҁv% 4{-`#t&wTe`:Ilobh<suR$r[]23^rl+\q)a_f=߳hzrR4ʊ	a(\Էz*E2˓F9/_dv5>	,a+|^3\ɝ^hAHv,JT
Eޜ弝ܵ7>񡸂Ovv_W<&%{1<$О]d;dn}w{3ZRnIhw,[j{	?q#Ͳ4I=9Á7EiCKX t>y{+l<xB Qo#[|eB7* -vLQ}TC6h݊+6pS}Kv0H+-1!zU$>"KAv Kd)AʝK6lWb)^,Y5:8TQ.~ΓvYGit ".ilyӫ~pY=?yPdB}'Y~E^Ϫ$M= #3rNpnaPq\GAG藏ϧ=!
}A}OnCG\C{#B	mS;vAYn~D$!ޱ.Ogfio>ŗc<@bye4y~^NmYn,*.z).s[>M's\ɳ[ԃ<K)z2<skYFRK|r7HNH06qs-fk\*gLf$J1{uh&>2*	t;뇃`(#Дc$}dY#yVINVRgeg-}Scoke({1kai!=Sva4E^h]U4p19jJ&IhوPBF~Z/r,A_2+06{)`E~;hVB+X>R0F]MѼ/m8sDa߂u'Wn$'b9SbȯKH k8 r(8 q 6Bj@m7f8nH1,UCMX5Ī[5_Ъ!I*rcD+Fi3H8e61^TR"DQKCx4pV\pK{tQFl eZB9@۲^"Ng\6oK9{yƶ(7bOck-VLم7H/le,%Siɍk,_VZI*$>wfEpb9icP0'f8	J{gЬ灹`74pY{D1U|?3a?X _1wP>M|8^^^s)ۚwՉk|[
[-K0x	sDϑra`|Vco0e$*~XLy'1c@8G=y&WS?S:.wbA1v.v5XQ2jA9oOI/ހ\{_!Sqq_U)äwͥO(.,lkX&+߂|vk{,uT4@!YZ{V]_XK]XO1Ф1{^qEOcMݒ)
6G~}NFAcWIH=	BS=1lk(
ՇS/|`}O^<IKL7wϿ Dxߟx N{q4$&!i]_{Ӈ\Q91T+?dAAz29k @<;S(6Y&N鷜[6=Nv Ly#]#$Dڙ 1S!Іҧ7*$IcɉEM5O`7(&qs7 Y58)f=Û\^o}W˽J줗/&&IQ{Wr6(ȩ'/΋'L]{Ѫy\*?7eqVg ,tTCBf	Y "ʏ}Bіf\rb4H#=/FfzɗXYr[U[(/íW^}`n(ʍ|g|Li7f|Sy]dՖMٜXl>Sҿrp|><x"p]Q
b\1UALw@Ϫϧ[k!Yld :ks`muWNA3ڛ+aP~s6*a.&r_YL?/v_׷e)to.[{E?>;ڴ[U1!c'`wjXÁqHQr]ezܩrJL0Qd[-XZf\|ܑBl9flj|lgO6!^t|
PekֲVZyؿ^]A9;p5׹Xb$cm:Qf)
-y?3M3M Yt<AX6#D<R0@FAu]-̨yMn-^<x'yg6WE*;z,V;5R ~XzDZعK՝ZG_ܶv܆-s9҉NpbqFy-91IrЌCqCT	|L1VctTj[<~>R1	 Fܯ^|r>r'˨A2{x+HX,E1'TAҬl%p]%-=oY2Jp_N--$vs!SH;ai
?hWΓHt1R<+lGaGÄC"8
_y-9C?=}qW,c=ʌBۍbEy >b'H܎DVxO2oTbPȧ_|7*t( "#A,~qT#kѶNUO'}ފ§#o-Y̷J!8vn	a+3!-40.<'K;q-Gc'wo^#<y^?[xthAؚuqPM$!SOy< [F\q/qq|?k7r25qTɝunnyn:N\uPV4).%|I:<]+twvSѝwqY9K'7LOjt_L8^EAǔ_Z5ku,_	ܳ$ELG:P.He9Oo0bPruآP#>/( jj61VC{LXr؈}7)cAaa̪2SV㡥wR=FceJV5ZY[cfuo3ur<>$d;:GC}NBwV6)gc_v;vּx
:Ni%|ڀ_k5:``wo+b[Gxdy4a'cB.]ҢqV 0DP~c*<ba48;I0zVD!CTlG~ˎK:W !5cH+6	srtUΡZ݆ˠďςK؏AM&W~CI
a`ܬO̑v]ۘI51ETz
Ѿ/?>vYqY&!ʏ~rtJƏC1s2ΉN{6[+hz6=/#l)0xpRhJ0zB.E$|<o#rCùLpgɇ`Lכ)MғʙQZP7|fgqz^jt$#lUO_m<~kOo^UDLDin,8b*VT W(A9dEںAItiiP~%xQyAm L3j[]Z8vxpp¤0;d ¤0Ma8'c1R㛐2s`{"V-θaxܺ/hȫC?ܾYOqi袲rLr# I/7GqƤ&yɀ9>M~~J艙>hO v8Li>ytTKq7q^+yEVEd2v O!'Hk~yxq;/rkMfj5Zw6ɪm[Td@M&&PH _[8rDWcܿq8%1*$C~g-hX:ixC5dUQgj*F}7o)ςrs*vpmAC/k'+4%,ǁ8$5+Q+n)LOs#CxF((rںio&>H}9joDܽ97;Wm<ƿX*l|yzw{gkoMg]7bry=qj%q3E8	3xKDl|t|ѧ(alp'o㱈8D+csfY{?D'(ݓϽځj
eAw<!8WYs_m˽'=plUg/7{{;/_>/vzRv֌3
f־"V5[JajbǗ{fҫ{$!K53g==$MJzޚn=lY7<uF[`|'Va4:e#LlڝVi)Y95\g\)Kk,#o.S .sMk{ŷ9$E1DiSz|0eݥYW0"XaEq[O~L fv4w<3~_nၗxv@t@4,:Gt?D
q?4Ir	]sE.9_m,,}ˍ:r@0-5o2svye?SY'Z`Ow/%3٬?"ȋ82juԭ jݛ/._|A0HX&|Qx^PjΨA,TdN
ei:@DdGwee{įr r`qQ/==?3?q:zw쿷]WrPkD9ۣ綶Hd$/nlTFl}d{̔ |_F?	m<sj[oT*jǴF\o|HN-?3kL5ݽLeR3Ң!+֌birKך7kyTc59'IF=g¼Z ciOca/ns6mDoYZYqKY!|	;.twϳPýA7MIz䬋tf@4:$6Z:Mg.icRbT栞rnr>gw?M1}7[kwuwVG~ӫ?@
{U?>@z4SO^zUJt?¤= J^4P骒F	\zғGӡyN5E@?`e'sQ%o?iȸ' U #{GONsX|&9`Α7
lQ27<d5W͗ihś쫣,\g@ms?Xrl-b:yǀ|9LL<4uxT4kŉ78&!zfmo6:lb}1+UR)?8>_|2:ެptn[012C&>[n0]Wao4_w 8Ôv[V@ LFwu0!7ȾU*_/zyE k-wNƪ@82ko[o*=ֳڂ׻G|@g5AZ_{i082&[Uޘյ?+]DFĖ^s{i v|f?7:SAWӹ\;2)@lh 4u6:mBCUkq)^$6t$wRLslCYBpֱ7X=id6~&$Uј*֧f_7)?(H伷yeQK<@G{
5	PXz hx\hҀG0nl9:|Ks%:rOD-%4Qs`/':ӚsѧkF`"hN0څ H13?6hQt<?8W0AwboLgZy?sf7,n@h
!F_{!(p1tvV 85A;+>,OY+a(bXϻff(*d$4m$̚Pi=̐k+?Q/o*P/ 8e!Oc<WQr*LUƊ>XElῪ;zgc>Wo!t?h0,x*zlYikvgc]k:]NU3p$>L*}Zk6Xw:' YZduPRP9"gtןf8ԧi*l& dhFg츝tֺf]mu\cuЮՎ\sĲ75w*.-jmu56֝vl9Tp;H~r*P:[_ XJ kֺ6D,lo%jziFmPS+ge6m_Xf]&PKAz7m(jz{t(.h:^D wǵvڎFᮮwVNgintFi A;jm?%݋kׄY.ZTެw@XXZ.~[xb{CqR9-{BukxmtVBZnV,h4(ђ6FhQm߿6v^J6nxh]E\%~]o ns ~l uaq}m
F3[MՏ#cbPuOqO|a)A慦C8й_<1[hrqӥ,]khxhD;WlPx$:.f_J<oޫ?ƪ~Z'pS SZPa!Txp+53/0؏0m;<gOI!RVcp=s.`%ayecvniloT*aIÜA05,\Ϳ`<-LhcITjS+KrPxzkboZVU8x0Ժs0WW=w%SLɿ//)Їe]1Oɯy>c[by7,]TA!~QH~ޟ۲8 C\gPXO6j*S231atI
ZCrV	V-jH1A2B$U.Qr21E
Id[Y[f?7?E[/s+VK/	߬Wz2<w3yv!Y߾e0fƥ2$@=:(Y&߽#!ϻåjˈ/SҐG_TDBxޡ ue1S̨c\\Y05(.C>	>_M~|e2kzNS;2)<FI6|!liFK1pSKMYȚRW̬l10{KM-ealRKUV4m
xTq_X^, HYy	sb`\PjrV^ѫA1G6X?%Ҝ8|gM9D'yh[4uOz.iY>yg8MWJOgQzE ^Ok[N6KMCTR)#:IF21VPA(%?A҃amUHzS]\	e2} ziB3mZLa""ly+t$~$ IOqC)[NV[HyR;D--uSov-eVj;h/`	h*ѻ囜G*KUkKtG@;{,zii6O+5j2=9BRS{Lj>ĐHGWDgZ	U!Uil+@ fk+$$0#:>S&ۥ#զɡ*qa c/Iޚ@[ ^cV
MU*;/O\c/يlDA иDmq9cb=uXs$ATRmeE~ce~OC8Yx*|=bd.ejFG?(bΨؑ\]sF"^-ݤ7/GV&MCtl RV^ҸKBRHL'
|N!I;1H	'RQs)ա/lll</R?&sOMyYV3c:Lz+9AxűwꘛpuKY,Hd},Qc"}#C36U/ KyCrjͯ·'~c}2w<rX/a ǢcUWzŝbl`IF(9dko!Z6yۜghb%1n bۗxP0h蹟U8[ml,QQX0I_!mT'^r"bTVBI`|"[xMs`Kǉ6sfy}y	Q3T	eNsGSU+Sl TFI6T&EHG6L*&xd6t;.jr-E08Tb0*]Sa\U_.VR\F_j`;L#
^o8	~yzsҼL&"YyCt1
m`'gfa,$9}AG;Z"GW
'L,5dL:B2&?'y898k}M%.&g"4Srp~w>).&4muef*{G>I$tĸC(w>]
dQ@9_Qj̦8H#S&}=a|Hd^=ZC$t{aS/Oi(vj}\ ^y<ڹl6sMJWf{x5X|{n`X. R.,Qp!	@bsM3|`C6GG;ғ!NoD? :qO9dh9/]n0
@+L0̉p0ِQ4ճ{9fكBvۇO<E,?1b|OCtUT/aI쪨䔏da7!(phv2l r|\g<$DCCP#oxY Fc?0$N<x~Bu@hJ#{7
K>ȦۤA8,ŕ2K#g0Uv5	Lp'h'm	V&_Yͨ|}]~zKb5Og$zSY8v=+[apJDBUYE	xN;V7[
|!K&Fc$ެrhk124THEQ3/?NHצ\dXB&&͍K2!d"7CDL|q!S_/ϖpX.=Qq? hwb4{H|`ga?2s1A	ԏq7مi*!cJ3s;"&rLϹGk}X)sEB0b.&c4;9E}jhč`렐Dq39Z/i%2PĚνI1㍛)hcd8(ϳ-a"J̶	sɟXF;(/ڢx'J.sZUzdu(ք4Lk{ȔZIID;YTH?(ͱ9N(FnW-5s%Em٬ 9|k湢Ǐ YBYf[8q.'wF{m5I\+Yꨓ2ڒ"ˏQ{Oфxh;#nFG:Y\޷SM"q OBGvwiv")TjL?Kt8Rר~	L,[ܨWAߕqcϟ]t@<y(=G_Px(LWjUZVE,hp*q=(7z4{Lf,v6tq2rc`ow?Qr~V5rО7bzJV!
ӡFF15 F,jGAmvwW`e(6N4(θ(>xn3ʅYոrwS=[WoauVY@jJ܅hf
K0wycRlx|o)dZ1DbJv0'mtLӶg2HD{>QZR
f&qt)I I_j`g:!5#j.,B zpg8<qrD.&~9Y?ƘķS*l.Xm21ȽYT|dAWrv&DB#cHh&jTUU&{mL5߄Bdn/>;0#-}gPu}Vpq8m˚,iPK_CgʟkwoWj=T|p`qEԓr}q׶9ƛVZQ4 7c{i,$u\"<77<V8D6dɦkf;7_\A4{F3KŠkK#Oĵ#OelM-RY#?SGR9TI#~d -pN>-i@}*]L8οЊS u1Φ-q*.Ȃy3r63UFUbXr]HOQMoxE?;vmPF>`gD6ʕQSUP`J{6O%&[w	T2nYfVE6ua{ҡ&6mov`<UJ ;Q6)7IEmQxŤQU$W'̈́:Ƽ_]HrOš33Kij[wnyrp	V^ǰLWo*5L*ͣM_/*A8cyǪt*UiU~	J~~?b:fjWY{{0TRZ%H+J?+㮹LKcZ/ I?; P:HT$^v"VZʒy*D	`Xk+<}gadĄ0(d "}OSb.f=4dHmXTD)VG rkُ9p9ްUaϿc/~%+xg=?0y7aKqXǅ` -HVc4	yKם+hrC2ǰJ>@
@wSf'+-6Ӕ.Uryo!Nf콵,L/j ~4R͒ y&~
CևJõK-I/dCk!Rzi`F'j&m=vE ;O^ ~zfO)+(Hɳd2+%;`tWT**Q1QI?%Z%Om܀i@0ͧ[w* ".pOQ 8Rog=!d	ďqWw䶏Vxd-$m`M}$ďmhdg6 {otջg9tuc+boCt>ٸN+4W}n>N~ϘRv6VAI[Ce3'hPir +$/u<4;A$q񜨀`=ŃZ1mAL$~5ͣt<Q2=',y8>ߗV_nm>_G@?\Vyvy rR>':gbmKTdp4{~jq N 