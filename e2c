#!/bin/bash

declare -r e2c_version="0.2.18"
declare -r e2c_os="$(uname -s | awk '{print tolower($0)}')"
declare -r e2c_global_dir="$(echo ~/.e2c)"
declare e2c_loading_pid=

e2c_logo() {
    local logo='
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #########         #####         #######
                  #######    ####(  ###    ####    ######
                  #######    #########    #####    ######
                  ########       #####   **      .#######
                  ///////////       //        ///////////
                  ///////////////    /    ///////////////
                  ///////  .////    ///    .////  ///////
                  ///////          /////          *//////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
    '

    echo -e "\033[1;33m$logo
                                Emma2click
                              Docker Magento
                          environment and toolset
                                  v$e2c_version
\033[0m"
}

e2c_loading() {
    tput civis
    e2c_start_spinner &
    e2c_loading_pid=$!
    sleep 0.1
}

e2c_start_spinner() {
    local sp=('⠋' '⠙' '⠹' '⠸' '⠼' '⠴' '⠦' '⠧' '⠇' '⠏')
    #local sp=('/' '—' '\' '|')
    #local sp=('◐' '◓' '◑' '◒')
    #local sp=('◢' '◣' '◤' '◥')

    printf "\033[1;33m"

    while [[ "$(ps a | awk '{print $1}' | grep $$)" ]]; do
        for i in "${sp[@]}"; do
            echo -en "\b$i"
            sleep 0.1
        done
    done
}

e2c_stop_spinner() {
    if [[ -n ${e2c_loading_pid} ]]; then
        kill ${e2c_loading_pid}
        wait ${e2c_loading_pid} >/dev/null 2>&1
        e2c_loading_pid=
    fi

    printf "\b\033[0m"
}

e2c_trim() {
    local var="$*"
    var="${var#"${var%%[![:space:]]*}"}"
    var="${var%"${var##*[![:space:]]}"}"
    echo -n "$var"
}

e2c_msg() {
    echo -en "\033[0;32m$@\033[0m"
}

e2c_info() {
    echo -en "\033[0;33m$@\033[0m"
}

e2c_info_bold() {
    echo -en "\033[1;33m$@\033[0m"
}

e2c_error() {
    echo -en "\033[0;31m$@\033[0m"
}

e2c_error_bold() {
    echo -en "\033[1;31m$@\033[0m"
}

e2c_result() {
    local res=$1 \
        noexit=$2 \
        error

    e2c_stop_spinner >/dev/null 2>&1
    tput cnorm

    if [[ $1 -eq 0 ]]; then
        e2c_info_bold "\b✔\n"
    else
        e2c_error_bold "\b✘\n"

        if [[ -f "$e2c_log" ]]; then
            error="$(echo $(cat "$e2c_log"))"
            [[ -n ${error} ]] && e2c_error "$error\n"
        fi

        [[ -z ${noexit} ]] && exit 1
    fi
}

e2c_ask_bool() {
    local message=$(e2c_msg "$1") \
    only_y=$2 \
    opts \
    res

    tput cnorm
    stty echo

    if [[ -z ${only_y} ]]; then
        opts="[Y/n]"
    else
        opts="[Y]"
    fi

    while :; do
        read -n 1 -srp "$(e2c_msg "$message $(e2c_info_bold "$opts")") " res
        e2c_erase_current_line
        if [[ "$res" == "Y" || "$res" == "y" ]]; then
            e2c_msg "$message $(e2c_info_bold "[$res]")\n"
            res=1
            break
        elif [[ -z ${only_y} ]] && [[ "$res" == "N" || "$res" == "n" ]]; then
            e2c_msg "$message $(e2c_info_bold "[$res]")\n"
            res=
            break
        fi
    done

    e2c_res=${res}

    stty -echo
    tput civis
}

e2c_ask_text() {
    local message=$1 \
        default=$2 \
        error=$3 \
        error_info=$4 \
        validate=$5 \
        validate_value=() \
        res valid error_count res_count valid=1

    shift
    shift
    shift
    shift
    shift

    validate_value=("$@")

    tput cnorm
    stty echo

    temp_term=${TERM}
    TERM=vt100

    while [[ -z ${res} || -z ${valid} ]]; do
        valid=
        error_count=0

        exec 5>&1

        message=$(e2c_msg "$message")

        if [[ -n ${default} ]]; then
            echo -e "$message $(e2c_info_bold "[$default]")"
        else
            echo -e "$message"
        fi

        if [[ -n ${res} && -z ${valid} ]]; then
            error_count="$(echo -en "$(
                e2c_error "$(printf "$error" "$res")\n"
                [[ -n ${error_info} ]] && e2c_error "$error_info"
            )" | tee >(cat - >&5))"
            error_count="$(echo -en "$error_count" | awk 'END { print NR }')"
        fi

        res="$(read -er 2>&1 | tee >(cat - >&5) | tr -d '\r')"
        res_count=$(echo "$res" | awk 'END { print NR }')

        [[ ${error_count} -eq 0 ]] && ((res_count++))

        while IFS= read line; do
            res="$line"
        done < <(printf '%s\n' "$res")

        e2c_erase_prev_lines $(((res_count + error_count)))

        res=$(e2c_trim "$res" | tr -dc '[:print:]')

        if [[ -z ${res} ]]; then
            res="$default"
        fi

        if ${validate} "$res" "${validate_value[@]}"; then
            valid=1
            e2c_res="$res"
        fi
    done

    TERM=${temp_term}

    exec 5>&-

    echo -e "$message $(e2c_info_bold "[$res]")"

    stty -echo
    tput civis
}

e2c_erase_current_line() {
    echo -ne "\033[999D\033[K\033[999D"
}

e2c_erase_prev_lines() {
    local count=${1:-1}

    while ((count > 0)); do
        tput cuu 1 && tput el
        ((count--))
    done
}

e2c_in_array() {
    local entry match="$1"
    shift
    for entry; do
        [[ "$entry" == "$match" ]] && return 0
    done
    return 1
}

e2c_requirements() {
    local test pass=1

    e2c_info_bold "\n[Checking requirements]\n\n"

    e2c_msg "OS compatibility check.................................................  "
    e2c_loading

    case ${e2c_os} in
    darwin | linux)
        e2c_result 0
        ;;
    *)
        echo "Currently we are not supporting $e2c_os based OS yet." >"$e2c_log"
        e2c_result 1 1
        pass=0
        ;;
    esac

    e2c_msg "Docker installation check..............................................  "
    e2c_loading
    hash docker 2>/dev/null
    test=$?

    [[ "$test" == "1" ]] && echo "Docker command line interface was not found." >"$e2c_log"

    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    e2c_msg "Docker-compose installation check......................................  "
    e2c_loading
    hash docker-compose 2>/dev/null
    test=$?

    [[ "$test" == "1" ]] && echo "Docker-compose command line interface was not found." >"$e2c_log"

    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    test=0
    e2c_msg "Ports 80 and 443 availability check....................................  "
    e2c_loading

    if [[ -z "$(docker ps \
        --filter "label=com.docker.compose.project=e2c" \
        --filter "label=com.docker.compose.service=traefik" \
        -q)" ]]; then
        if lsof -PiTCP:80 -sTCP:LISTEN -t >/dev/null 2>&1; then
            echo "Port 80 is already used by some other service." >"$e2c_log"
            test=1
        fi

        if lsof -PiTCP:443 -sTCP:LISTEN -t >/dev/null 2>&1; then
            echo "Port 443 is already used by some other service." >"$e2c_log"
            test=1
        fi
    fi
    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    if [[ ${pass} -eq 0 ]]; then
        exit 1
    fi
}

e2c_install() {
    local archive test

    e2c_info_bold "\n[Installing commands]\n\n"

    e2c_msg "Locating archive.......................................................  "
    e2c_loading
    archive=$(awk '/^__ARCHIVED__/ {print NR + 1; exit 0; }' "${0}")
    test=$?
    e2c_result ${test}

    e2c_msg "Extracting data........................................................  "
    e2c_loading 2
    tail -n+${archive} "${0}" | tar -xzp -C ~ && >"$e2c_log" 2>&1
    test=$?
    if [[ "$test" == "0" ]]; then
        ln -sf "$e2c_global_dir"/bin/e2c /usr/local/bin/e2c
        if [[ ! -f "$e2c_global_dir"/ssl/config/v3_ext.conf ]]; then
            mv "$e2c_global_dir"/ssl/config/v3_ext.blank.conf "$e2c_global_dir"/ssl/config/v3_ext.conf
        else
            rm -f "$e2c_global_dir"/ssl/config/v3_ext.blank.conf
        fi
    fi
    e2c_result ${test}

    case ${e2c_os} in
    darwin)
        if [[ ! -f "$e2c_global_dir"/mutagen/mutagen || "$(echo "$("$e2c_global_dir"/mutagen/mutagen version)")" != "0.10.0" ]]; then
            e2c_info_bold "\n[Installing Mutagen for docker sync performance]\n\n"
            mkdir -p "$e2c_global_dir"/mutagen >"$e2c_log" 2>&1
            curl -L \
                "https://github.com/mutagen-io/mutagen/releases/download/v0.10.0/mutagen_darwin_amd64_v0.10.0.tar.gz" |
                tar xzf - -o -C "$e2c_global_dir"/mutagen/
            chmod 0755 "$e2c_global_dir"/mutagen/mutagen
        fi
        ;;
    esac

    if [[ ! -f "$e2c_global_dir"/ssl/certs/rootCA.crt ]] || [[ ! -f "$e2c_global_dir"/ssl/private/rootCA.key ]]; then
        e2c_info_bold "\n[Installing CA certificate]\n\n"

        if [[ "$e2c_os" == "darwin" ]]; then
            pass="e2c"
        else
            pass="e2c0"
        fi

        e2c_msg "Generating private key for CA certificate..............................  "
        e2c_loading
        mkdir -p "$e2c_global_dir"/ssl/{certs,crl,new,private,serial} >"$e2c_log" 2>&1 &&
            openssl genrsa -aes256 -passout pass:${pass} -out "$e2c_global_dir"/ssl/private/rootCA.key 4096 >"$e2c_log" 2>&1
        test=$?
        e2c_result ${test}

        e2c_msg "Signing CA certificate.................................................  "
        e2c_loading
        openssl req -new -x509 -nodes -sha256 -days 3650 \
            -passin pass:${pass} -subj "/O=Emma2click/OU=IT/CN=e2c.local" \
            -config "$e2c_global_dir"/ssl/config/rootca.conf \
            -key "$e2c_global_dir"/ssl/private/rootCA.key \
            -out "$e2c_global_dir"/ssl/certs/rootCA.crt >"$e2c_log" 2>&1
        test=$?
        e2c_result ${test}

        e2c_msg "Password is required to trust CA certificate...........................  "
        e2c_loading
        e2c_result 0
        tput cnorm
        while ! sudo -p "$(printf "\033[0mPassword:")$(printf "\033[1;31m%s" " ")" true; do
            exit 1
        done
        tput civis
        e2c_erase_prev_lines 1

        e2c_msg "Trusting root CA certificate ..........................................  "
        e2c_loading
        case "$e2c_os" in
        darwin)
            sudo security delete-certificate -c 'e2c.local' >/dev/null 2>&1
            sudo security add-trusted-cert -d -r trustRoot \
                -k /Library/Keychains/System.keychain "$e2c_global_dir"/ssl/certs/rootCA.crt >"$e2c_log" 2>&1
            test=$?
            ;;
        linux)
            if [[ -d /usr/local/share/ca-certificates ]] && [[ ! -f /usr/local/share/ca-certificates/e2c-root-ca.crt ]]; then
                yes | sudo cp -rf "$e2c_global_dir"/ssl/certs/rootCA.crt \
                    /usr/local/share/ca-certificates/e2c-root-ca.crt >"$e2c_log" 2>&1 &&
                    sudo update-ca-certificates
                test=$?
            elif [[ -d /etc/pki/ca-trust/source/anchors ]] && [[ ! -f /etc/pki/ca-trust/source/anchors/e2c-root-ca.crt ]]; then
                yes | sudo cp -rf "$e2c_global_dir"/ssl/certs/rootCA.crt \
                    /etc/pki/ca-trust/source/anchors/e2c-root-ca.crt >"$e2c_log" 2>&1 &&
                    sudo update-ca-trust && sudo update-ca-trust enable
                test=$?
            else
                echo "Currently we are not supporting $e2c_os based OS yet." >"$e2c_log"
                test=1
            fi
            ;;
        esac
        e2c_result ${test}
    fi
}

e2c_on_exit() {
    e2c_stop_spinner
    stty echo
    tput cnorm
    echo

    if [[ "$(basename "$(test -L "$0" && readlink "$0" || echo "$0")")" != "e2c" ]]; then
        rm -- "$0"
    fi
}

trap e2c_on_exit EXIT

e2c_log="$e2c_global_dir"/log
touch "$e2c_log"

if [[ "$0" != "/usr/local/bin/e2c" ]]; then
    e2c_logo

    if [[ ! -f "$e2c_global_dir"/build ]]; then
        message="Install Emma2click Docker Magento environment and toolset to your system?"
    else
        e2c_is_update=1
        e2c_res="$(e2c --version 2>/dev/null | tr -dc '[:print:]' | sed 's/\[0m\[?12l\[?25h//')"

        if [[ "$e2c_res" == "$e2c_version" ]]; then
            message="Hooray! You have the latest version of Emma2click toolset. Reinstall?"
        else
            message="Emma2click toolset v$e2c_res is found on your system. Update it to v$e2c_version?"
        fi
    fi

    e2c_ask_bool "$(echo -n "$message")"

    if [[ -z ${e2c_res} ]]; then
        exit 0
    fi

    e2c_requirements
    rm -rf "$e2c_global_dir"/{bin,completions,dnsmasq,docker,functions,local,traefik,www,build} >/dev/null 2>&1
    e2c_install
    . "$e2c_global_dir"/functions/e2c
    e2c_sign "e2c.test"
    e2c_global up

    e2c_info_bold "\n[Installation finished]\n\n"
    e2c_msg "Emma2click toolset is successfully installed! \n\nRun \`e2c --help\` command for usage information. \nVisit local https://e2c.test to check useful links to included services.\n\n"

    if [[ -z ${e2c_is_update} ]]; then
        e2c_ask_bool "Initialize new project in the current directory?"

        if [[ -n ${e2c_res} ]]; then
            e2c_init
        fi
    fi
else
    . "$e2c_global_dir"/functions/e2c
    declare -r e2c_project_dir="$(e2c_get_project_dir)"
    e2c_log="$e2c_project_dir"/.e2c/log
    e2c_load_project_env

    case "$1" in
    global)
        shift
        e2c_log="$e2c_global_dir"/log
        e2c_global $@
        ;;
    init)
        shift
        e2c_init $@
        ;;
    sign)
        shift
        e2c_sign $@
        ;;
    --version)
        echo -n "$e2c_version"
        ;;
    --help)
        e2c_help
        ;;
    *)
        case "$1" in
        up)
            e2c_local_project_check_dir
            e2c_local $@
            ;;
        add | down | info | remove | restart | start | status | stop | update)
            e2c_local_project_check
            e2c_local $@
            ;;
        bash | cli | composer | db | grunt | magento | m | magerun | mr | mutagen | node | npm | pull | push | redis | share | sync | varnish | urn)
            e2c_local_active_project_check

            e2c_res=$1
            shift

            if [[ "$e2c_res" == "m" ]]; then
                e2c_res="magento"
            elif [[ "$e2c_res" == "mr" ]]; then
                e2c_res="magerun"
            fi

            [[ $(type -t e2c_${e2c_res}) == "function" ]] && e2c_${e2c_res} $@
            ;;
        *)
            if [[ "$1" != "" ]]; then
                e2c_error "Unknown argument \`$@\`. Run \`e2c --help\` for usage information.\n"
                exit 1
            else
                e2c_help
            fi
            ;;
        esac
        ;;
    esac
fi


exit 0

__ARCHIVED__
 <] rG(8[_,A̺@E	A	Ӽ5@@ͪRf@y:{v=f؇]udDfd] Qypw֠j4.^~k^鶛lZ/IŀQ8/IɎfPOѧۿm6.ja4xǟoNsyqQo7{wV.jH+ݵm\h}B
k۸ 04<o7]i0~2NgV^gPʮoo|nyQOc?
*
~'o0{/_oܵm\F_w5ou{7[`G<aS&؀}o~:~N5X3/<gQzǕ/Q0c?Mi?>ј'ABiX&)\K|v>! )H4P<w+a"+q{MOF^~.=6&f!GL_K/:n3n@(`pBD" Yxݗׄ9|2:OFP@8$DI
t`n'c4\g!í:%7[J7/~4ny}j[7;a:ozoR}W*.YusQ7.:Ag1/?1!Hxw^h⦣_݁Q0ӽ^P&	B\,×I;ӪH?/$)p?te^sztqw6/ϡT*V>#Cot A$bϪo7 &80Ca؍0X7dI4Y)|`t~ 6ƼG5+GA24;1CN8Αmkծ۪jmVkK`^<0sovoo6oފ>d@v	d@rTii);t^6UM	6l6lA:nu0?=_j#H*L$5~WW&gZBA#Az9G+ڮVwUvmjRHQ"`Yw]>Ot4bGhb	{+y5~NKpq!_b]r2'ީ$t?@0$Er*9U^B0l̙ pGVEh
JCN]؟iml?`=ʥUE&`vUIAG7k&Q2˽֫XV_m<K??$Zgun:`\TwE	}(\N/&F_<h^|0̟&PYD_1qsY3D>'@-]^VkvJldX\i,9FԼ>c̡_W{0/D寫8;Vu7/;x2^u>6Zڷo8\֬4YsT/MɿJy}ØSw@&IpO5K+ oRAy }DɛeP
)آ!j6GYJƣ,[	+2ۃw5	j__IjmܲJ̇odGMBpQ;O_nlml^rY;!1B53=`DB>;h&~(:s~x~N20s:,1U)zt&&uM8xֳ-(G=é,Zq[{3dϓ_FV#7vMRH GLۯ1Q&wf$yHW8'o.p(!B؋TY2n8qmX2>PUQdh|J)LMr+˷۴j$][ck+5kKe>ȠZME"ȋ
H!eUPI0eBشΒ`,JfM`{!+7TUV}Y_4d}W/:#7d@CPy?,_e~Ł*n=~=$% vgn(筽?ˌPܜ[-?SYͶ~ճ? ' /`(uY찛UIgJ>9eSSڦ2dF̙2oQAͯ ;}|LŜ ں~5@jXĜWD	ЋpTVqr|D^0h ' OprMx r,oFho$fg/<n57#mcZ͎|&UV3B7)6f7Sh Ѳ)\%ALL!K`s+I?Uy^r|͉:w~;<
-Z3A TWԘ٫2grk^=Fal~yjSLKM]>Ҳw҈6YkH#dK9P}>8FC"h5{0ކ@fpY \$cI'BZs~aǿoL%d^8 4&;bZ&T eN
xhۗn=͞Bczn:>[Mw>{}?ow_B6F..F2:X\ZA",H"Kƈ-%Aga'LLlW3-=ga=%pيM(EB֫/aXu42폴R	r<JԷp<f%( B{&#޼<H@ާ\k̈Zd틬IPMpX*$ΕcE~ox讬}|~_59b|1bdrj	m i۱RLwӲk$h؄T#b/7_}A@ܼ]uth:|Fg!)*}wov4>gh>M'NX̕*T~x7)6@Z>9oe+f	?Q ] 1o0 fp+׈U zgehxIx!M]5D_~og'[QKp
I*ĒK:&	c*bJ!`S j/}5dd>[uhА5+ٔ:R/K9@`M{
iWQ&e-*5Eky^l˘jspNP6T6uS[>0i:}u19+F2Ix/WUj(57II`!ĩ`/=C^uBSJ<xZl48PF!leWQK^(V\j5ڀeR51iEC_XhZ+Fy~	_-R]$%]^e=ͨVt]j~T`Lc}S2A\M!RLD
T8nFR~_b=gjT+l!RK~,}/)8i.:T;*MO]d$7uT T%SB5MvUjA0ijIi?cDAhDYBfÍ3m cGgA/
C[3IW瞏GU0|wbˣabi B;cs;asK2 Ͱ.bB+vCKuM&F&5PVT\&269e],Wуg!u`U=&&ZNi/D`׉Ӻ^/Uf7p8B~;b/`ne
PJI%9,I}js4˷)DK'
bVzX:pP'ͥȲo[UfebwhJ䟧U{5_+՚^^p΁֗-ucɟoaMՑ=Zb;fkd sɳUKIVFcrZK߂`G`ʄ|}4boޮS=*FkD#e+ֽ8I|SثnH߾_NqQ3	%BX\rAR޲QtRTtZa2Ҫ̫-f!-y7(5Y# ,=z!۰ $Ds4U{њ)Bb<T6{Mv^='>GjJvsa~~&*t)[ub=ғMH:?LQ3K'zSIR_50E<)(l[w&NX4d"?cӒ$5_'hЍ,ĭO]AvnN|lNq5a4rqS+y+H#9 3%{Uqh`kĝ[7QV4>mP}״h4! Ą񥄆v>[xX!'eϼ>K@Kз١xю*]$.{ٶlspiĄ׶,7!
Ɨ"7ˆrȱK΁ߚC`E7kl"#MQe`P-2Mqs4TmN9'%Y9V	r,4p{;Y;-~&7zko*U~n>eM

'|߶^Qnh9K·m"NIiA3hy3 48ZBUHw@J͝!HzX.C}H'$xtrH ?TyfnWܭ*#M9%b=bC{#/QUtDgH}21Ը{P.K,*[xI~E!DA'y(q1 S-;iڜzdBw=$fiZʷuXV8ϥp|,7g_ 5tO/1[<\ZaZ1@QOf@|$b-`|`TvCq+ JDCWbcSle._
*HY|85{~OFFw3D<tPz	]{|=wYC߳{&wPGG~ل~`A2p?GeW<HΪHyC~$]̓^h[ϥEgY9!{ۗCghiKs^DSfle0Pìcط!o(Q ;E/0\3zo%go<+ -`0sǞ!:ky	fO)6Ld5Bn΃5d zGOШAr N
˩E.p{+:]ǷYDӔG>!R70@C=a{Iq'^@;{8e!u1xG&c,C>荵4VK\Rx7zS<@]x
Q!^VU1IkE?%Yxkς#*ƞv2α&Hߔ$fSnuENrslNi
`D]KLeJ"9
UP(* 8yy^y,IFL^61ϿFd(Xq×!	T`>){ T|pބ&Qrpt1|ca7+>iwEf(x+"$
QRNu3cwS7plGWƨ·i-Ϫ/޸rDDdi|ZL{z8HurlpxX]Ы19_VdTnde֒5
D7N=CmbH.6i&i!PgExNA):!/v!u~Z$bhA+рgim-PX"\`
=nu]".c\Ёhɛțiɛ >Rd!Y,A_D!oHD!oH@Rd!Y,A_/@0)&n ݆[Ww=uQwmu*RZ
^Kա  4UfYJҰ'y$ɺh~Tw~`{@pKހ11ޑ`Xq@`1vn\$Jf"S6{g|ɉnWܢ_k1'eHy顃2HIW{{^P3(8SM?KLr[~~Gt[Xt~0&a-c͵4II^6t8%KhkQ$Ӻ%9I@@ޚ^wg@e
^Rl\ț dqe.=IkfUDrQP.2XN_|շЯ2KH.!HO$г=.L'Z{o'\V( ;r̣e?%o3wW[U2ϧ5*n=~z1PK.
oŸRٹc[>+ۊvDS`*j+d^cnr{f;wlKJ-rIfFteڻ7eW>4uXB^OWbc{Th	3`Ƞ+v%ްf$.
o8,w,AU`y	G]=EJ3x1Z{rcjL!]%rɋ+EyTh	cYRs,sdޮVE+Ja1ƌz֠[Ÿ(SX*l1Ơ,tMctxs-{*<Eq5/,Э7jZ,-1	^Epy`V}ukwĚl,	~"[y2ȳE/]~7;rneaK<eW츼Td
/3rߕyx|[eqU;hn	,G%}X8}snbU'v,^5B?HQ4]r~N}t?[m[0˚Lf3^}5yx򪮬ųygGhJvZ-ݛK3ղ$}[Ij/fηEpQ25-faZahLc/r`4r3mZLm2a[,;)PG0`򃾽ƴ|N)72^\s9P% \xDxzg~\S>of~Ei8:6X%XKK4YLbV-+cd5>賏{0WuCQ
P4rSjC?^(ދQ49055:fha_Vfc)V33-N<ZU	;{ˢVs@~m3}<F+fvޚNl!Ò1W'+L?_N;(NxSr+M$.j{q9wW6=6#oyVaMڃ-R$5b5v|;l M=fJq[|iXe	-A8w+?oIhKcxceq3~Rx"éͫv4I;-$$ZB*rf.6)wh'/\qt@  Ki3nz}2=nڡJL{xJ仕TGmr)۪BAi0*LIษg5/2[(HW~ݗ?tjïGA@J%rꑞb>|Vg뱎q9-jE*3Nr,8[Du'C4^$KU\nޔ`^#ۣ=)(i}`s`耋-e(NHݔOm:3>՟֫w.ra4B;{9&^E?{lωz?"Q'i|dwo埑hhGo;Yr- ,TQ4p R=Z/׶Z{{;ϷgHk_>KJ 99}Di5a=BgqTw3 4{Voă؎}ZP	mUɦh£ux0Pa6	+'h-Q^; J(ϹY Nq.G)~Cb=]4x}-42Ϭ Ng˃P0pc10&@31WЫiL[㦌!f&(:"RHlm]Z]y):c[\?|p񮾒1ouZu#:>K.FaOVFcXfT)6!*ZbEt;pr0R8{x̦5J.Ƞ<,	ұ(<ɠ78Y*"ˬ>Ǘ3הWcjpx5͊ul_;M`z-^;`z-e(d2s9qny'/m
,`VPq]h3EPi>,Ǽ
keŤ0IP	4F˩@	od_UUـUXJԷ[>Ƀ~8l{&Z y4Bڶ~5Pr`jo'{i{mJ/˽OTx]]%0{|D<n7r71)Ӥ&e{T_0zJMG_G}ˆilN9Vhê{?"07ܲm|HΩμ)ʈQަoN5Yƾd]h_A0FD>tA1-yo7Ġ3=SH#κo 
?[ْAs2|C<S&,Q<d=I j4e΀5xx8U[ie'u]L7[11(HWsxYNvuLBOVz^.JsEU<3-Gɭ	Lַp]Mi/%lL ]+[UY<H+[Y,T:gr/)Hk..(bh*6UKso.xlEۖioV_AaR&;kK8g5]|jE$.(۷?JVܞ`يQ/	.\3ɲ u3<Io`C1; X]q)H8KN8l{~y,&Z`;0gM0VC}[.>K4q*BZrB5J	/U2G˺uN5I7"so+ͷ?Y.۟yWcIP;8xęo=Fv@wQuJ ?EZBJl{	0$8hLa8-x"=UPJ vHhd&XL&R,#tz*C.|(9>Ҙk	碞d-04].l,-K1"{QҩxZu(Wf{K3SpۏL|pvƣBi|Ȗs҄[yC|jNq h	EwGAJ\)u5܍G
󀝬2ZD<_jjyW3a]ϵ:V2!slR4#*l)cB>-WB	&1qQޚC踘gOprXp<,`3	!\}^Cy$a*XpBev~Aԩܨ^Y![p?K?>v_k^ÎюtP[f
!%$~åsG% 3nd}&ǔqεљ&? uG=vZ.<Bs!c{da=+tRt,mJ\~<!ajV+ɊIlYGqiV98"r^8ymqp<RuKEn ӟHƵaCVꇡ8=PU<T*\G֩H:L,]YZO/xYDfzk:IÅsʽ[mrY%..X.!_<-zն-¾XC1GjnGruF<,5YA:+LZlVI,䯥i8uvW+jPE%}4l^xv97ׇV%kwְ𪅗Y@aԃQ}@PZ"Y4B󜆷S"pͺht:,IEzHG7,fI"oX.ę[ZfRk	NY5,"L'VZ1N"M97RP)Un%.~Q<kX'DIڄ~_
9Td+*[0;谦Re_x8q.ln4dO+2ɫ^q߸ö1rw@OgEw5eTI{´-tEb|UfS6[0ltŁO*rM̰.0^|J{܈X-vq\ܙȦ=zEs~WyS">˵jPm[%[εZTF<6-ĖqZ0]clXVq:7%]*+4-ɊHCsg-Gj TBxV4Y!_`3m e25Ya2\3S[7ɺiPn˨$\yI}CyJ*]8@f;<LpʐW~F}]Gk#rU|Y9Wv÷zՃ^Ɍ`Xc5N$gu`"C3<+vr}XӞe~yxY% ~j9wQ OdO[EBAnʳ@~l)w.7MYZqs4yf&w$)70ݓie괪9XE
P.tV>~! ]f,V92^dizVE&ȏǗoc˷)~6]^2ceg3UMYDz95.E]<;Z5c:G^4rm6"<W^I=f7ͪ:`xތޘNO;KLJ&fܛWs2b^=es,sэ n}*=A\XsVK^!zOU~H	M|S	Vk {اSΚ9NKуtfzsc`h(-5لyG{[zs stp˺rm*o&ښ 3\KVZˀn&<i,J	!T%L'xO	
tIK~=v9tμI>G.Ǎ99d%{UV9'ԙPlfh~z=|7(s}>AGY6I8Cz)jhvN6;um}w($cw8R<Gsz51s}(YdXKWm׈j7C<MNe:M$|iLy68}<cQ	?bSyR%6% BŴ^mCaA'X=D4W7I);粥ys\_jipRIL?UÒb@}KCX%%OVrnb*{[({S`^9*>3|
o-/,*pQefɘďPHR]igM?eվar'^!*_H@I(J9}S/W֛j|ƌ.bf.=;O5qJ?3TYM`*6ЎBo f~%a6u̢H^{<A+W'yM&CԔGrNRlBn0pkBf0XXm-WFX>%'3:{v@[OnvڰW}Y0#LekvSOHfAݼcR$'"m̎5baA3E_%t_A(lrgZ`8>pD=!VM\p"osNnZ@A~P<ǻ{;ۯ^/nbHP=JņtPhϲd:öyUnIJhw(K떬[	q#tͲ%TI=9q7fEiC+X t>yПx+d<hB Ico"[_^Fx&I_;9ʏt(K;[C6h͊˯5mb@V4`WZ1!zS#"KAr KdʝK6lWbeǅYj4q<>\-8'|y>qS2֕oiDUҬkV{_ݟ( ױ!6[~L!mކ:5c%9W/,<CUH~+zEf䜈a$\P!.-{N6O5{B>'0\$0~^E'SZ#eJ%Ohӄ<y><%_,^~Kj>7GEߕy.:JҨPѽ.p0 1ܵYvs=T,]\@'4[*u徹GN,XEUex3"jon:\y:`K׈U:ptb9ѐMܺn&3DE# Q"6${JOY>	̑I"L'+D'q2H/-Sce(-z6kuaY.=Wva4C^j^@Ǿp18jJIYPBFzZJ,xp/g
^tk.iN0YfJ7WfOL2?sцk0rr>zS}4s[9N"S8w`݀ɕɉΔ8sR)(- 6$
6H*l lGPePڍY5J.O[5bi|V1kVgjHTifQ1NA6yMF'T,Q}*"sDX+咬~8%]}<фZgüж̤lsx8ےFjg~gѢ-JXZ@d!^bvM//>[Y$K=|TZr"(8ʗVҠз§Ik=Oi \@Xf;'9nD@겶4m+y`!Fk}H03v+<'x`&KO+Nӑc(qVk^@@a;?D
WmͻjG޵jYU!S	rXLVRH40>*L'Ǳ71}m[ftiCGlY3PQ.pkGyΪM5yx`qx+Kmv&}V}pLıGBOeҋW W40GT⍵ 4tqn`%%%}t|d[\ގbvylO柉&7 3$+k/ղr1Syk 453F+詯[9:EiBow18=*)U(_x9'p|pEu#o<۟۟c)&W<'xsy$&4$m+:_q}+*,'H~Q4Hu#z8HOx^2@9 hVzq"'GujŦ65)S{Õ3ưɮea[\ cC"ğO;S"T(ǭ$/=J5M؃JDŠ܏	q0OQћx8LլIpOzb=>雋K.-3>y %v	eB$(Z3i'g}Uynmc&Ϯ=h<.ZMqY6;!
٬B +BQ\rSbTHo5Uτ76N>oR*JGAxf8lv}<8wZE!Vn#<t>eJ12ݯbOBbASAsż
BPX.u_oYZj1tbZbi`a$L1VwS\8Q	s	4˘LªgZQ0x_-H	Р|K6I/Z*H݉$}Ԧ@ʮ4=	8yz	ksHF
,zLk-{J; %cl&nЪ`w0,bl\І5WC'd3<{,	z[|Lhχb%[jM4.h%І<o' kӦ6KUoYki7soF}{2gG˲XX摂2B=hmaF-or[hh4;*ZO֓fYڙjg6ag#ΕX$22*Զ52mq/ˑNt{5G\.mEHfPJs輎o5F[ծ*i1HɍQ*OЈū_l2Gv>HpPfbww"*>H՛U.PkAE\QA BFnW'xҺVX,9koh(7#Z$t4Bv̭
C+$Q(!$WyKcO|_Uv7X2vcX}m|2XA(+2;! 
q^]!qbB>,Ц ,FVlί}oJ'?|uG[:UQ?PT*SV/>i~[fh9͂gU
AsN~a	o1҆qv?Y_P6ђA4rN<;h	}p>md2B{vּ7h:.&	H>~bɤ2;}&<cqYqiHt(ss~eeh/Vv:gG[`YK9wM4>Xi]\@>	Z}[?Qz}VU<QyLOjUDPWҕ .=lM=oجOXt TCc%h(W-
-R~|KVaFܴ3.ʄ%{w1h;Ѹjir?;$?ƨZ-:nehI|5noGV5NtMhv[?ͣR8Tb{ޗdGG3zɥxWhNsqO1?AWhfyq?9~ce =zNi#:~5כ7PU*_|p?RhN<~L-\E9A`?Y>=98U(hxH` ,$9#'P9̬T+zudoldhO<=bTiMΞyT$:>ku./?>.Z?ݎ4^	;Bw9)nr[+^},@BLi<Qsmc"tK
\	Pw(L*Ddz_~|>'%$uIIY&!ҏ~ztJCzUT y>L*cs{SϺֳJ:LO<ǅpߚ:{
5>ֲdmB	zOIIb$[j8)3Lp6bABV yLL=4?zxriymxv?XU7ưt${;e6S QZvA<"$15[뇊UT@&
y$ykPxA AAx	2?0hUÛ)c쵕@oiލqrfIaɗ@90I	2|afq:H63oDܚWe	tgYXz{	`Fou_zW'~
}c^pEy G@{KeU^eo2!IMrs}O>Mh=JQ.qhO v8Ni>wT{?gnҭ򊬠1uVeK' ޟBN^' ^LSL$YY74_k0'? ۬j5m\b5eUnZ(ԛhBeKΡ"dWNL_q0f-%[}ܿ8#XcY7IF_d
1+1EkȪxFi۸Hz8ܜсrbݢi\:d2?a?o:M~	I 6 soTB᡺HkQ{k5of7fvct?B]7դVz9juoٽ;7;Yﶠ]kV7~99`d]PX傑L;O_nlmCLLq,&Zāof>ay _Q#z?tӛ-cowrYR_ld"L$xO!s?do#?i}qF\;{B&}O/0>HaVIzC ^nyScy|/(՟g?`?=o+b>#%{/^*jO/~|ozb/pȥp{zӾV̞V|$MzǗuz}pfyﺍڙ6Fz^ⳟ7w[5Wz s7z;,?k,߂.P\SkL'co.S  sMkků9$YeigaʚK`ev̑fKkt[Xor͑K%~>:GfenѰ@PӡM4W{[;OvxЄe%Nې~wQĮt/	Kef%O?%`nYj6yl&--~P㝃ϟ1CKFyMp;k>EBAopiԦ[QAԼ7]~KFM
&F;?jkCmu<s8ǮACPy"K+؂%ihC\ã*Y_-O(d`{Luyfpj۸.+L}X6"ӂS[k$hu'AXV*'6r>w2]WQN?f#p]훭뷲+TOvKcV%E7T?$r'?t5yA=vN5K˦_Җ!r-jГK,X3jM?BHF.]k^[ƪ7,Ofʙ/τyuM_AҮ?:fm\64pkޝKY!	;.tΓ.P]@7Mizl̀1itXHm_uX,H	X]`WKRWz٧.2Fɛ,cvo֥v{[{bO/wCE*<Wo|o:ñz_=q6S#Qa2WO*ig0=}<zț7r8~Y- (V+À=n^	(yIh@(ր>i|8z2wu5q sq0:d(7)A$ٛ|0?vc>z1Qo/YC@|AnUjƃ@C?<aѸWFeN@;n4?Ij9hg^f9:*M&xV%ř^ԓ?Glo-0鯢:
GFq=2dݵAe{@L1iGh_nu`
D ?讳NA l<`c.xG(Fs^oח̿=jg-:=v[ic}ufAh6{9 z92NtFW>'{w78rpf\oVhv &ێ ڽlnj5׏B
T	Y :mB]bKSopBVlF\:;ofIN,!cebMւO4Y2F#p?h{M
Rz!9mDjoE0$ 04nMB>^zGywbo2)TiÖ \?Zl~
 !'i
dptHF`Yı5Q04'BO}՘|h6iqsŠ;72<t~n7nu4C/T+Q Ce	'ZGM01MJZ~鎍g2Nw6fjnIbG(4G&UzJօΧ7e~b&XTNb_BKAyMPc>VQ}6[*jY}Ul*;d~w%aq6kt:mw<Qf6hSFcvC&?&aZ|>ֵRp7:,Anc)xKPGQWe(3:O2'JvlM@v;Ψq;uwͶk\g yW#nXg]o}뢾pnrz+:nƆn -rz)s^ N@.D76:<m {NmtC L;.(ڭwv:~0Avjn@yl3E`x|= 
tk**xEz J+kA[ձMH耢o'`ϝu*]o;:n6N4t΃ .z^m>ˇn>y<vpO IEVGF䠟Ձvbd(鎐7N[GoSZjrۀxA^4;Pu0P|j6TEmj'??h"wۭA[<p]v?	#~h ns ~<@3~z3[MՏ#cbPuO{8ij'0~GY JBS`ytO2Zl{UjT
i<K}>(< zƿ3/%`fՁxS|*|i/|0PZPa"1T{pSst4ⵚcDoƶ'$vhFT8ֹZq0q?ѧ1^Ń=q(lv;Or}qZKN*PG0aN#H[UaGПV֦0$*H5y㵕FrV{<еFc7-)i`<6jݹ`_]w9|^Sޮя|i>,~?ֳK|S[ޗTF#iZ۲* ZgQWPXW6Ij*3s1atEY@rV	V'8jH1A2	B${]Dܣ'&y*V7'Im/Go_:~/	߭W8w3yvqX߼a0MFƕ*:D++5+{5Q!F!M&o{wY59GB+A_JCݨ&&AC]kbHP} #6@`*}a'j9jY7q>FjW.#|ͽ7W|/E/S@H1NaM5^.9X] m5hC֌eyfˈGԢ]ﯴ8XdE9Zن05Q	?g\Aj$SOR]؛T6R-Of^0v:4+q{+U5ew%n(Lc?I`f&(
GYE4о|cPzE ~OiWMVKMCTR):IўJ2Nc,Z:WR&Kx @[ @*Y*_1| w՚iJod
ydO\!(%Hj|bHMWZ@bϳEWWTJG{ꍂԮLZMA4 ފ;{(]b+]H@x~x?MFN!~VA*2IU72eC❬^""Nb[X7c\CX!%	z\NBG4خ(6$IUя/c|2Մ 0GGZh_R)y}{Vd'
%:h3?A.	QW1JrK\ 诿ix_}=
?e dC٪_&oU٦ZQ$Oi0J5zctHI9oVlRVM}+*T7DG Qu)fSB	RHL'
|L!Q;1H	&RQs)ա/<x1Q=VM(Y{F9NRkk!Ffp!t:	*9X'Axűw1pvKI,H\XUD Fg4zfLKP=Cˡ5?lt0ކJWЋ}c48F4 ^U\1gjŴ9N&}R.![O[^~7|%#ot|&0JY2"}![e銭&"x+!+FE|>k
5sN[q_DkJXb<Nac1KG)GJH(s;XF&J	H%Od_dJqm)Htnä".'lAfNͼS/ynGRMMw0,î1>\kr9űP`f$:bM W;ϙ-e:5$sVh;>0p6f :x<ϵWذ>RCͤ#$Cn/qs虣.ωc)ׄTrz(PA3%;RпfD7ظYeo\v'逪X[w(땏rYT=ж?:a67i6N>ȔI߆sB0WF~{r:̰'4;~>?yt! #/|,Z^</wV]xvV[@&gkӋ5L>=dpm|0?Q)c(
bhs&U3`]6FK;ғ!oD?0:O9dx.t7Wxr#~D8Rg3
·nx:~{PƇٙ@j¤Zf{_1d{i!C*\*q$vUTr{JӰ GF4E=V9D{1.aG?GC>7,tFm|'s<?iu{PP!-Q[dmR ~pcf%Q`B֑3*ph4u9yBăIdzVg[3/^w_շҨX>PˎpvAl3PUFo>tƟVFn/nȺǒ0q؁K77ZmMtURixO0i!+$ЧI6vsL&xFbbǳUVKlayáC	 ❘3R8;Yip{yăL}`GЋkj\?Xδu1[Ux^rԹDAAeǭDU"Zyc	̢eiTFFSQ0uPHO@9?E슴(b}Ͻ-I1፛)xi}dPDna	Kn3̖	sXFV`S]-QxC<_J.sUz8eu(V4&LWj{ȔFR78Y3Z`2r8`P\[jK`"ےYArsEonͶ.qb]MoAxfk[ݓz}V2Q;e}%3E(ﱟ);(wⳑG$t	logLTAEb0@JhDRP+-٘L1hsگQ-lXQP*W*?oG84xr_Ep_'oPZVELp=	zQ/;j̈Yllhd:@A5墑?4doMjp<5o&S.3z#6eiB~%4C? C]ҳr:/6_aX8Mء*;;p&fWn1.ȝ}تOO5ݚ,Z~JUV*pD37[/`TyWbwK6$Q'*fS2>9\̈lo.|:m	@KZinD+L`dB'`gxCg*p~)鯠J4jx^ {DN6V&sxx)=&jɔS)T21*݅YHwl;dAWr;Fv&D4. F1k&jTRUm&[+zs* ߇^|La(ZϠ%pd٘3pB3.XRac[!>{ƑO_s?Yv^\JG osn6y53zwB4r"Nٖ=x>ZK@0ʂf~l0+%z$X,KC&Fg9	絃H7tV~Vm&ąA;Pvߨ(}-v@28vqIך`E*tڸg&Z**i͏dܡ) OY2zgFr!w]i{9MdǙYQ9ǌ*ΎeXr]HOQMoxE?;v=|<d*UAtܳy(7YK2iu,,0,$ؓp4In{ۮORB QމaFsAZi5WUEEULEOc\!z.m\.n4/DyMM"da&ZFe<00RCxo*À5L*ͣI_*A8Ϫ+W*7L*/ afnU%I_W+ML7VƜulm\o^tnM >sUB"x\|TĴV^ƣ
*j.w!LpᆤL(T$^"fZ0˒i*|GΟ0
dG
>Ľ0@2MbB2Xˁߊoib.f-4aP1Xeh<~sjû
ߌϟsQoTE2Np?GU|ý߼0HѸPDbk8$zu}K1^b4Kӝ+hRC0J2fN&aǵiJ~MO* 7>^[k߲(f(W|i&Pe 
S(  kka+=42h>J9g|M2{@vɟ?G SQɳ>2l|̲pfcel1IPCsE(ptNa
Uǒ:n@ zd擭;iKOÀ~7½x`rǸD?C rGiL+<p&d643=﫽[S|@A =GN}Eq]7שfj`W5[>q0~%8_o)G*!5#blFR|m
V R.B"zDn<cdA >p,RYBA1 0:@8 ȞWsMg(]*OT$d6K|Ϸe/yO7P<Ok=hk!`i^/I8O4ęy[#~ &uw]wuw]wuw]wuw. 
4 X 