#!/bin/bash

declare -r e2c_version="0.2.18"
declare -r e2c_os="$(uname -s | awk '{print tolower($0)}')"
declare -r e2c_global_dir="$(echo ~/.m2c)"
declare e2c_loading_pid=

e2c_logo() {
    local logo='
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #######################################
                  #########         #####         #######
                  #######    ####(  ###    ####    ######
                  #######    #########    #####    ######
                  ########       #####   **      .#######
                  ///////////       //        ///////////
                  ///////////////    /    ///////////////
                  ///////  .////    ///    .////  ///////
                  ///////          /////          *//////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
                  ///////////////////////////////////////
    '

    echo -e "\033[1;33m$logo
                                Emma2click
                              Docker Magento
                          environment and toolset
                                  v$e2c_version
\033[0m"
}

e2c_loading() {
    tput civis
    e2c_start_spinner &
    e2c_loading_pid=$!
    sleep 0.1
}

e2c_start_spinner() {
    local sp=('⠋' '⠙' '⠹' '⠸' '⠼' '⠴' '⠦' '⠧' '⠇' '⠏')
    #local sp=('/' '—' '\' '|')
    #local sp=('◐' '◓' '◑' '◒')
    #local sp=('◢' '◣' '◤' '◥')

    printf "\033[1;33m"

    while [[ "$(ps a | awk '{print $1}' | grep $$)" ]]; do
        for i in "${sp[@]}"; do
            echo -en "\b$i"
            sleep 0.1
        done
    done
}

e2c_stop_spinner() {
    if [[ -n ${e2c_loading_pid} ]]; then
        kill ${e2c_loading_pid}
        wait ${e2c_loading_pid} >/dev/null 2>&1
        e2c_loading_pid=
    fi

    printf "\b\033[0m"
}

e2c_trim() {
    local var="$*"
    var="${var#"${var%%[![:space:]]*}"}"
    var="${var%"${var##*[![:space:]]}"}"
    echo -n "$var"
}

e2c_msg() {
    echo -en "\033[0;32m$@\033[0m"
}

e2c_info() {
    echo -en "\033[0;33m$@\033[0m"
}

e2c_info_bold() {
    echo -en "\033[1;33m$@\033[0m"
}

e2c_error() {
    echo -en "\033[0;31m$@\033[0m"
}

e2c_error_bold() {
    echo -en "\033[1;31m$@\033[0m"
}

e2c_result() {
    local res=$1 \
        noexit=$2 \
        error

    e2c_stop_spinner >/dev/null 2>&1
    tput cnorm

    if [[ $1 -eq 0 ]]; then
        e2c_info_bold "\b✔\n"
    else
        e2c_error_bold "\b✘\n"

        if [[ -f "$e2c_log" ]]; then
            error="$(echo $(cat "$e2c_log"))"
            [[ -n ${error} ]] && e2c_error "$error\n"
        fi

        [[ -z ${noexit} ]] && exit 1
    fi
}

e2c_ask_bool() {
    local message=$(e2c_msg "$1") \
    only_y=$2 \
    opts \
    res

    tput cnorm
    stty echo

    if [[ -z ${only_y} ]]; then
        opts="[Y/n]"
    else
        opts="[Y]"
    fi

    while :; do
        read -n 1 -srp "$(e2c_msg "$message $(e2c_info_bold "$opts")") " res
        e2c_erase_current_line
        if [[ "$res" == "Y" || "$res" == "y" ]]; then
            e2c_msg "$message $(e2c_info_bold "[$res]")\n"
            res=1
            break
        elif [[ -z ${only_y} ]] && [[ "$res" == "N" || "$res" == "n" ]]; then
            e2c_msg "$message $(e2c_info_bold "[$res]")\n"
            res=
            break
        fi
    done

    e2c_res=${res}

    stty -echo
    tput civis
}

e2c_ask_text() {
    local message=$1 \
        default=$2 \
        error=$3 \
        error_info=$4 \
        validate=$5 \
        validate_value=() \
        res valid error_count res_count valid=1

    shift
    shift
    shift
    shift
    shift

    validate_value=("$@")

    tput cnorm
    stty echo

    temp_term=${TERM}
    TERM=vt100

    while [[ -z ${res} || -z ${valid} ]]; do
        valid=
        error_count=0

        exec 5>&1

        message=$(e2c_msg "$message")

        if [[ -n ${default} ]]; then
            echo -e "$message $(e2c_info_bold "[$default]")"
        else
            echo -e "$message"
        fi

        if [[ -n ${res} && -z ${valid} ]]; then
            error_count="$(echo -en "$(
                e2c_error "$(printf "$error" "$res")\n"
                [[ -n ${error_info} ]] && e2c_error "$error_info"
            )" | tee >(cat - >&5))"
            error_count="$(echo -en "$error_count" | awk 'END { print NR }')"
        fi

        res="$(read -er 2>&1 | tee >(cat - >&5) | tr -d '\r')"
        res_count=$(echo "$res" | awk 'END { print NR }')

        [[ ${error_count} -eq 0 ]] && ((res_count++))

        while IFS= read line; do
            res="$line"
        done < <(printf '%s\n' "$res")

        e2c_erase_prev_lines $(((res_count + error_count)))

        res=$(e2c_trim "$res" | tr -dc '[:print:]')

        if [[ -z ${res} ]]; then
            res="$default"
        fi

        if ${validate} "$res" "${validate_value[@]}"; then
            valid=1
            e2c_res="$res"
        fi
    done

    TERM=${temp_term}

    exec 5>&-

    echo -e "$message $(e2c_info_bold "[$res]")"

    stty -echo
    tput civis
}

e2c_erase_current_line() {
    echo -ne "\033[999D\033[K\033[999D"
}

e2c_erase_prev_lines() {
    local count=${1:-1}

    while ((count > 0)); do
        tput cuu 1 && tput el
        ((count--))
    done
}

e2c_in_array() {
    local entry match="$1"
    shift
    for entry; do
        [[ "$entry" == "$match" ]] && return 0
    done
    return 1
}

e2c_requirements() {
    local test pass=1

    e2c_info_bold "\n[Checking requirements]\n\n"

    e2c_msg "OS compatibility check.................................................  "
    e2c_loading

    case ${e2c_os} in
    darwin | linux)
        e2c_result 0
        ;;
    *)
        echo "Currently we are not supporting $e2c_os based OS yet." >"$e2c_log"
        e2c_result 1 1
        pass=0
        ;;
    esac

    e2c_msg "Docker installation check..............................................  "
    e2c_loading
    hash docker 2>/dev/null
    test=$?

    [[ "$test" == "1" ]] && echo "Docker command line interface was not found." >"$e2c_log"

    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    e2c_msg "Docker-compose installation check......................................  "
    e2c_loading
    hash docker-compose 2>/dev/null
    test=$?

    [[ "$test" == "1" ]] && echo "Docker-compose command line interface was not found." >"$e2c_log"

    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    test=0
    e2c_msg "Ports 80 and 443 availability check....................................  "
    e2c_loading

    if [[ -z "$(docker ps \
        --filter "label=com.docker.compose.project=e2c" \
        --filter "label=com.docker.compose.service=traefik" \
        -q)" ]]; then
        if lsof -PiTCP:80 -sTCP:LISTEN -t >/dev/null 2>&1; then
            echo "Port 80 is already used by some other service." >"$e2c_log"
            test=1
        fi

        if lsof -PiTCP:443 -sTCP:LISTEN -t >/dev/null 2>&1; then
            echo "Port 443 is already used by some other service." >"$e2c_log"
            test=1
        fi
    fi
    e2c_result ${test} 1

    [[ ${test} -eq 0 ]] || pass=0

    if [[ ${pass} -eq 0 ]]; then
        exit 1
    fi
}

e2c_install() {
    local archive test

    e2c_info_bold "\n[Installing commands]\n\n"

    e2c_msg "Locating archive.......................................................  "
    e2c_loading
    archive=$(awk '/^__ARCHIVED__/ {print NR + 1; exit 0; }' "${0}")
    test=$?
    e2c_result ${test}

    e2c_msg "Extracting data........................................................  "
    e2c_loading 2
    tail -n+${archive} "${0}" | tar -xzp -C ~ && >"$e2c_log" 2>&1
    test=$?
    if [[ "$test" == "0" ]]; then
        ln -sf "$e2c_global_dir"/bin/e2c /usr/local/bin/e2c
        if [[ ! -f "$e2c_global_dir"/ssl/config/v3_ext.conf ]]; then
            mv "$e2c_global_dir"/ssl/config/v3_ext.blank.conf "$e2c_global_dir"/ssl/config/v3_ext.conf
        else
            rm -f "$e2c_global_dir"/ssl/config/v3_ext.blank.conf
        fi
    fi
    e2c_result ${test}

    case ${e2c_os} in
    darwin)
        if [[ ! -f "$e2c_global_dir"/mutagen/mutagen || "$(echo "$("$e2c_global_dir"/mutagen/mutagen version)")" != "0.10.0" ]]; then
            e2c_info_bold "\n[Installing Mutagen for docker sync performance]\n\n"
            mkdir -p "$e2c_global_dir"/mutagen >"$e2c_log" 2>&1
            curl -L \
                "https://github.com/mutagen-io/mutagen/releases/download/v0.10.0/mutagen_darwin_amd64_v0.10.0.tar.gz" |
                tar xzf - -o -C "$e2c_global_dir"/mutagen/
            chmod 0755 "$e2c_global_dir"/mutagen/mutagen
        fi
        ;;
    esac

    if [[ ! -f "$e2c_global_dir"/ssl/certs/rootCA.crt ]] || [[ ! -f "$e2c_global_dir"/ssl/private/rootCA.key ]]; then
        e2c_info_bold "\n[Installing CA certificate]\n\n"

        if [[ "$e2c_os" == "darwin" ]]; then
            pass="e2c"
        else
            pass="e2c0"
        fi

        e2c_msg "Generating private key for CA certificate..............................  "
        e2c_loading
        mkdir -p "$e2c_global_dir"/ssl/{certs,crl,new,private,serial} >"$e2c_log" 2>&1 &&
            openssl genrsa -aes256 -passout pass:${pass} -out "$e2c_global_dir"/ssl/private/rootCA.key 4096 >"$e2c_log" 2>&1
        test=$?
        e2c_result ${test}

        e2c_msg "Signing CA certificate.................................................  "
        e2c_loading
        openssl req -new -x509 -nodes -sha256 -days 3650 \
            -passin pass:${pass} -subj "/O=Emma2click/OU=IT/CN=e2c.local" \
            -config "$e2c_global_dir"/ssl/config/rootca.conf \
            -key "$e2c_global_dir"/ssl/private/rootCA.key \
            -out "$e2c_global_dir"/ssl/certs/rootCA.crt >"$e2c_log" 2>&1
        test=$?
        e2c_result ${test}

        e2c_msg "Password is required to trust CA certificate...........................  "
        e2c_loading
        e2c_result 0
        tput cnorm
        while ! sudo -p "$(printf "\033[0mPassword:")$(printf "\033[1;31m%s" " ")" true; do
            exit 1
        done
        tput civis
        e2c_erase_prev_lines 1

        e2c_msg "Trusting root CA certificate ..........................................  "
        e2c_loading
        case "$e2c_os" in
        darwin)
            sudo security delete-certificate -c 'e2c.local' >/dev/null 2>&1
            sudo security add-trusted-cert -d -r trustRoot \
                -k /Library/Keychains/System.keychain "$e2c_global_dir"/ssl/certs/rootCA.crt >"$e2c_log" 2>&1
            test=$?
            ;;
        linux)
            if [[ -d /usr/local/share/ca-certificates ]] && [[ ! -f /usr/local/share/ca-certificates/e2c-root-ca.crt ]]; then
                yes | sudo cp -rf "$e2c_global_dir"/ssl/certs/rootCA.crt \
                    /usr/local/share/ca-certificates/e2c-root-ca.crt >"$e2c_log" 2>&1 &&
                    sudo update-ca-certificates
                test=$?
            elif [[ -d /etc/pki/ca-trust/source/anchors ]] && [[ ! -f /etc/pki/ca-trust/source/anchors/e2c-root-ca.crt ]]; then
                yes | sudo cp -rf "$e2c_global_dir"/ssl/certs/rootCA.crt \
                    /etc/pki/ca-trust/source/anchors/e2c-root-ca.crt >"$e2c_log" 2>&1 &&
                    sudo update-ca-trust && sudo update-ca-trust enable
                test=$?
            else
                echo "Currently we are not supporting $e2c_os based OS yet." >"$e2c_log"
                test=1
            fi
            ;;
        esac
        e2c_result ${test}
    fi
}

e2c_on_exit() {
    e2c_stop_spinner
    stty echo
    tput cnorm
    echo

    if [[ "$(basename "$(test -L "$0" && readlink "$0" || echo "$0")")" != "e2c" ]]; then
        rm -- "$0"
    fi
}

trap e2c_on_exit EXIT

e2c_log="$e2c_global_dir"/log
touch "$e2c_log"

if [[ "$0" != "/usr/local/bin/e2c" ]]; then
    e2c_logo

    if [[ ! -f "$e2c_global_dir"/build ]]; then
        message="Install Emma2click Docker Magento environment and toolset to your system?"
    else
        e2c_is_update=1
        e2c_res="$(e2c --version 2>/dev/null | tr -dc '[:print:]' | sed 's/\[0m\[?12l\[?25h//')"

        if [[ "$e2c_res" == "$e2c_version" ]]; then
            message="Hooray! You have the latest version of Emma2click toolset. Reinstall?"
        else
            message="Emma2click toolset v$e2c_res is found on your system. Update it to v$e2c_version?"
        fi
    fi

    e2c_ask_bool "$(echo -n "$message")"

    if [[ -z ${e2c_res} ]]; then
        exit 0
    fi

    e2c_requirements
    rm -rf "$e2c_global_dir"/{bin,completions,dnsmasq,docker,functions,local,traefik,www,build} >/dev/null 2>&1
    e2c_install
    . "$e2c_global_dir"/functions/e2c
    e2c_sign "e2c.test"
    e2c_global up

    e2c_info_bold "\n[Installation finished]\n\n"
    e2c_msg "Emma2click toolset is successfully installed! \n\nRun \`e2c --help\` command for usage information. \nVisit local https://e2c.test to check useful links to included services.\n\n"

    if [[ -z ${e2c_is_update} ]]; then
        e2c_ask_bool "Initialize new project in the current directory?"

        if [[ -n ${e2c_res} ]]; then
            e2c_init
        fi
    fi
else
    . "$e2c_global_dir"/functions/e2c
    declare -r e2c_project_dir="$(e2c_get_project_dir)"
    e2c_log="$e2c_project_dir"/.m2c/log
    e2c_load_project_env

    case "$1" in
    global)
        shift
        e2c_log="$e2c_global_dir"/log
        e2c_global $@
        ;;
    init)
        shift
        e2c_init $@
        ;;
    sign)
        shift
        e2c_sign $@
        ;;
    --version)
        echo -n "$e2c_version"
        ;;
    --help)
        e2c_help
        ;;
    *)
        case "$1" in
        up)
            e2c_local_project_check_dir
            e2c_local $@
            ;;
        add | down | logs | info | remove | restart | start | status | stop | update)
            e2c_local_project_check
            e2c_local $@
            ;;
        bash | cli | composer | db | grunt | magento | m | magerun | mr | mutagen | node | npm | pull | push | redis | share | sync | varnish | urn)
            e2c_local_active_project_check

            e2c_res=$1
            shift

            if [[ "$e2c_res" == "m" ]]; then
                e2c_res="magento"
            elif [[ "$e2c_res" == "mr" ]]; then
                e2c_res="magerun"
            fi

            [[ $(type -t e2c_${e2c_res}) == "function" ]] && e2c_${e2c_res} $@
            ;;
        *)
            if [[ "$1" != "" ]]; then
                e2c_error "Unknown argument \`$@\`. Run \`e2c --help\` for usage information.\n"
                exit 1
            else
                e2c_help
            fi
            ;;
        esac
        ;;
    esac
fi


exit 0

__ARCHIVED__
 +֝] r9(د_eLIy答bQTukRI
fheFdEDb;Ogalk_3_K Uͨ38 Q_}Zsu>knm7YZk/z&IŀQ8(َPOm6Aǟvgi5V -5Fo?;;-.w0{QX;o?4BAZnI0|:δooW;k-kχR{Kcp|ɇ{Qsi Wݵ;_K~Ѹxn?
5ug]Zn+{Σ	Drμ0eXz'XE1s'~\C!;4Y&,S?NQXz$a"١?jXDc~F/dt>/WgĂ?D0W+fB` H2 evvOHD Q}l5a@߅¯O|Fh&Tf'Q	ԙp+`No1O7Fcv\lލx7;aogR}_+]̅rXusQKF~?}OXg+tژXyķW0[kip=tefL|$AeViU2QVx_]xr:aį;9OY|uvR	`l0W	xzM4d's|V}h6i7GqOq0-vn4gKNp(7G?I{1#Y9
*ߧ߉"vatl[vVU;nZ^Qf]2]]ۡmۢMۨwb| %%]%..E`ZE`Z`
펽 7Mmfm¬M M =/fP:FWo:
qf+5j$'qK+AZ^ǜ#V]rmOF*c:eeA(ê?ȕ.{\p2?6=WE	_ eɂX̉w+:It>8 ̯uI
uNyUFsƈ|#W"i4x!'~.q촶p#opMR:zO7φ?(N~}jE,v`ǟm:,RH=X@Gry>ե(]QCj.V(AłQ'L1cV#/U?}
`~z
2 w./5{%6IMl{Ȝz` j_1P^!L%B+bΎFYvsxwڧ楖; גK嚕c?!kpn)7 <;5O|sjGDrgy w8%H#mݥvPD2SDCB
<ha' QV'g&`'֦q}`s44N[ֈMI\>i`7K"By0%FfBlv~4{B^N?7Ӂ̡zN}F0kcUf]NF'/o8x|*Qcjp*^\ލ 7مoDT9R#H,kL4].xI^Ly{
m%8ew7${!K&cM`'nYAG*l  եOTm 3IS	_rR	U`)x.}V++le)`Xƾf]ՔLP$ЯaBE2|8H)Jb6p?%-Ǧu8'g["̴wD4kkЅYἙs#v^~)4&&/~}O UIqx3s/'ߗ6aow )dwpSD	lq]f2fZy
?ـ=)@IˢfìJԾR𲗭h(26Œh0b΄ycP
n>H/ m|22sh 6!c)sw%/>ePYF1
my pOC܃<inWs4EByvxIbw? *%PR	;cO܊hp
̭_Uk5;vTYNtTQo2Rl1nv\"o5AE!Sj慘ZCV"l~yYJ/${y*h͐s28P]RsO~vfgʜq>?{|d[;u}h#%'e/&ﬧ[m>s4pӑF:2r|p8E%(Ak`*߿5,"J's`Jg|'=
ii1їi~{܃ӜThnBj>Px*I82aoz6{W;ֳg%šdy/w/B6f..F6:_X\ZZ yY$McĖɠ0b&VNF㩖3I8l!z}"!B0,auure
Muq;m[83Np _={oSFL$ Ssv5D-|<Eւ,(Ƹ_rajՉkr"78tVZ|ǯ_sWc;= iB"j,v{<i	6!AC@$(9K2Ebބ,d^|<S~^.ۛbه`чVIÖag$PB8UZq<fP6šg:筬wŊ3r?`DCnEԠ`޳YBۢ		lW-$ؗod*8u+jK )T;ui ĢI؅(XR~p9 -Ko=z:8 Qe*4$-d-Ŏs.֋$IbA5G֞Bڕl'!}a->FZ^^
\k%9ܣ@N5UqLU:ʌ|{#?$M<+)5dѸhUT0ݞO!EAAAߋs)H,/0r1Q[YpԒvM-Z`Yo|eL1F^ї61p_n$ė3\׬Iu|nWH3]~%f@2؟1&ŔqWS$$B*)XoXj4⭤j.[Ԓxn!K~-.|˦UpP1Yu2-63UɒP-ӄ]UK+bbkکjRe8Q+>Q6` TY0ʅBpbR4a<?#(/bؠDЏX܏|ZftwҒ&@xSs{ﺟӨm]i0GﺓI{ai04TU>̫f@Ij-Uq z	A]=XVW8>C	Szyi0'a#u.Khe~Y|ie8A!0*}2(CȂ$l9A}ry4w)&P|'
bVzZpP'ͥ(o۔Uf咽mWthN:䟧5{9|g]]rM/8RTWxtFVȺ̱Ϸ0eȏGkm8s1W[s58Wy-2~]͹%Owl$
319NoA`0eB=BZq4hשN#J=NNˑ^N$)]$o_/&s۸fMmax/zgg!Q)EaoYd(P:n)`*yBLCYniUіAӐAYwu4FV]XVr"ex:dܽh!?R_^e*[ݽr'/#C5e0>es:Nɣ:wp&$(@뙥 $/BG`s?lGw&NX$d"?В$X5o'hЍŭWSAvnM|l.s&kC:i`cWVHGs:AgQKNaԤr;o0cǭi5߳fۂ@ip2K?	O+		^}PBN˞{|L鉗oC7CUH\&c3ǻW
0ӈ	PYBMn@^;ă/UEnMt&ґc9K5b5F6n؀78CFFJf`P=2IptTmN9'%YV	|r,˯4x;Y;-7ko*WneM

ܶ^Qnh;K·"NIiA1hy3 48[BUHʴm {$r|TT|
#,W>I:@rx}ڎ2S'+VIƑU
ަjlqeEq8E>Ĩ*zO3AB>⎘dn<=(7W#l-KQ<B$S1 /y)q> 8iڌvdp#$fmtZֆʷuZV8/p|fO|.7g_ utOZ<<ZeZ@QϠVA|,b-`|aԄNKq+~ FD׊bgSlg.w^**HE|8{~OfSD:tPz	C{ggs.CMpO7	~`GAw?e$gݿ	*HwZۼsʏb|[?bu.A/{\ͪː́35G9,q/XYSp\JS2CaV17ݨJSFpv❢pX|I.7^7ޕyHpLXT㌽{S'@zehfg?hC7;A
ī'hԠd~\< rj<ފN1U_9ғh㈜Շ3V".յ?8ԇi!O5ȝ7X20\p7qSduZ#HᓀRյz^᎔	3A¯Z"eMIV/Fy)9:i
*pC6UVKh3Epc"8F)Q1Ś&Q#+O)L-3_E*6-1DB&W74,4Eˮ,<#2o@p}]3ծӀeI2d{5}97[hXA	Ŋ${2G4bMc$T++5WZmB/3;]BO4EdŦ@!J?A2BӔĦ@-=Hj添njO*MmwSv7V?&wڂNzSt>VGtGG4cY0Q5ఆ!D|5](:BלCŁhF0	3GB{4Dbm$"--NE	K8JAu&>WgW|vħf!ˀ-+t 1+:/]#嗖Ҕ_7kYD!5
|iސ7$|C"ߐ7$|C"߰#7\YD!5
|v8ѷF3XۺoJ,%(Rmh) 2 MY4YyYVeM Tߊ%؋HǑQ+I/GWJacH#XqD`1iq\$JT"sЙzgrܣ>Wh<_k1'RCyfA[qdѤWV+=j{Ir'\r	t_g(}-B[h'?1tZz$;`QɹS3S=8N R*BgJTɴaI(l@staYZ.+񏂏Ko~и)3)wW?'e0SOԦ,'Q,[d3tcO~8S%G޻e8<g	׮E4U
n* ,+ܗŴ,(j$fw|,̅%Jc2|B|C<ãT[e߭'ρ{=!jE!Z+;狲a5M5&WbjmRE,!b(֕L{ǡKhוX1UZ
]rF76B%Q
l9/Y밇ak^wA0ƞ<j S_aEr%(9*-a(Cj5Q`,uj(I*-a3_m̠W`|$kM:]bզPeX%4eqo+Fʵ1wbVZ<*{KڵXDc|F;on\)Э6=,YD^yc3gӫ.ۍ_,o|q7ͯy%ީq{].er <'/saޫzqn"3ĥ=p]		O.VsX0-\h0~Khg LF,x^Mڶ8au,fnǳ$n|S]ZAG%3>O䞏0:㕥FrFӁ[v75V74IZAK7 3DbןϜo!X5&C+ej47Ԙ^2呩p2_g~B۪";,e¶E.Sfobf'}{eKo
6	"ל3hAΜh}+6mqtlJַz8[wjg/ih9>k?f+=kЃd~PhmsVe4kk<0ž0jfS8ukҭ8`+Zg~[\,y11vUff9YNEWo;5E1+]Tab O:?VX&\pv*󁮹%Pܯ=&z|UH\b9r暯lV{b36ʝ}[쥢Ifkv4=rcѨT)[z!7L
*h[uepG2
9$YD9-}	ŧ;]VD!
'N=aKIF#ZI:ITr.\GRN^ЕG3%ؓ,N~
f<_EgxrH.HC?}{+iK+s>?U4WiTjYqS/"kgP#*e_˝텁k(4=&͡<}X5-}W\=sa'[ԊTa6$9aA1)xAT-TYJNŻ)TuMs5p=aړB_v?d?V.IBv\1Mxp35{Xil~k粬/zWZb%Y
^m˽'g#n-̯q/Ow_S)ьf-ֻY}tZ(?V,G^ΪBe^xAQ"XXًx\xr{Y	|oe~b'{4F~gq8{Mt^Pփ9NuJߩ-YسzX$LvխJ/oJ6xGkǃ4zqX8hNMu]TvPA
qpk9Q6sG7l|UOܰ8)NCAߍq  9
O!4\B'1 B#2'7| jwiv1gᾢHފIqqp R>abfA:>K._Fa\VGr`XVTש#ZbEto&RX8{x̖5J.߼,1/<ɠ?Y(ʴ1Ƿ3gWcjpx57͆Mus:qL`v:y`v͹eo(d2tD{#e֝2GT)UZAE7w
	#A aLb5B%˔Z&Y)V)WF
Pa)Q2o.C;$R y(a{+vXnf۲!*\
kzOH)$PߗZޗgC/g]TH{`K?ft"j79Zi[Q}V0TJMG_'ȆklN9(0;"0w<mHΩ.*!ޥIYc_.dj /yq#v י摀7UOlnbҙ)KW7 UV䟮lnzX~ C)!V(:t$ 5a2Ϛk7*-SZIf>VA}B#JDK5>]z]ŠơsvʇڤT PLyr{q)c4[WSNl-6Sa+8AGVUVpM
ǳ
Z+ujǌj󇣬9EѶeUcI KtT!I@N8F-lYMu^woldOR	ֆ3,p~4ePjʹ7Yq}(px*>>	^CztgT`o//">s a~` |}k9g	MPUH#BNY*jUF0X&F8}&R፽yg"+xx~3t0	|8'!5qV.M	G0SH[35@\W	?8B }/<$(V'}7F'kL?:mҥFG_LFq\ZXc}W]@}vI{-9ǈFIkiJ$b8c\=XՏB97kP[m?6fA	{u-XIlI+/:}%xnxꏏOA*As{?Vdkؖ\ ZP˻aZgU2!cdqV1WK3"i
J0Wyj7q+6˹ЏZ\;G!!؎.U:oWni.Xz7@K͊ᕅ$"W1kh5 J `e(kQBb'8]:qA0FHyL&g:bb{L^y<c@pcWٞ"ʓ!4<GL!E"1 Hq+CxA_gV򕕡}ev.bޕ \d^1ĕk#h8d~c
w2vv3"XJT:UIVK+Z/[U˖X/Lhb.0D_WbMtU2Qu:BtՅ/$ˑM/6VuX8Wrq1k(x9C͝YhyǁEf0K}1L`Iېjy'i07MqpEMd-3.fZc1e\z^1=kᓳv(wF0ʾO_J[ĵ"=Khv
YV%4ϨThj>^}8UrLv-:(KyTJT"I1B~(F<ʣ7/|B[$+6\=U/3K!lGa}tXsַ<867:loߕsS?ʯ8oan9ͺV]"mxŻ	M2Eޤ=euqnږ`"1*L]qb拊ASi83lsײ\c7"rSg7wviχQjㄟaBݾjޔHy=zbZ6vxs6+Mue޺-Lzטku޸viM	zaJ7bez"%y˕(F (;!Sl+vJ.WïM66Esiq0:+TaƤʷr۔:]@]FYc3фC8I6lt3QTPTpZr1v'Й"NZݨOc$lwmD/HF12JZ	8rP"i0a6a8bNgm9Jd˃ū?%wD<]ufqwJ+rE7O7Mfi#t9ߑ8h8+4xzwOfT{sӪYzg=<s.@Y tX|ynjYMGrJ!?}rw\^2c!]^K1]tr9o?jRj$0LԸwi֌5z~SȵՈ\[xAH,'u~{|WW#eu0ݢv~1WM7s7x\z&AiXfAܨMPga/m87Wݽ@B[0g8^V_QWqL+ ³5dbYZ_[j6(لyG}[xs s|pr.)0mRmeL #ג2`樛
O%@q`RBH2Dɥ"1{SB]Ӓn0(Cyf&m,qvlcNN).Co;o3o+ϑq!tWY$tT*ƟC)jJY@j2mQ,ӷg~1h8V&V}ru.M4»/lvc޻pKHQQP{qx2y91/3})YdXKWmj7C<MndU$|iLy6ZC݉c^	禠?bxR%7%n Bƴ^nCiA(X6>{E4w9I)[-zs׸^_kiRID/?WՃÒj@{KX%5?Vsbg\{T`ڙ9>3|=/,תrQef؏WPHR\j<dM?=j߰e[=/Fܓ$$\)K++kMpj5ܾMcFNs}vitמ
7jҊL`YSYMn0M.hWH3
ג+08nQ<KarG%N=^ot,!jʫ9W'eMr:!e85!3h,,Ƕ@υ+',e1O=;'7{K+E㡬5O}R$nޟ<I)n{Kfכ10_ӠޙpBe0Uap X!mhDUЪI~@nPY])x7+xdwog˽zCl	*[]SAjEOxw7%a@vҎnyM7,
^Ata33xcQ6䰛\
Bg]L'r&˃)%\xi8=BN<Q/|bB8i7tQ.e7K5d֭ͯ~Ris 7;9ڷ,nWU@*d70DfTٹd̶|%V>/;͒U3Cg"h<iKΛ]},p~K]M Xf}^zޛ7N0GEO
5hM.ԩa^/ɹ}`Y5@[4_02#D'9[
uieqyhtD~||P9=d~Ł9:= Ц<%c.;_ᦁGĊjM|ffxF`#X|i=!Sp	$6
WF쇊p1؆Հrb:a2Wt2͕<Mqe`J=,<_e$T''sˁˁYjC?r`F҉{ƄlFˠ)W8l#s뺭Iÿ~81"?<Mi7JA5gd(%x6P0Q>qV҇iQ=5\f^Ҽ!lӹv=^3_hmlOSUZEs+ VdV\1y5/hD"'|)cj睯FjZdS !kuY* (#S/<lܠunV>G-X7`}reFr"3%6T
J  	+8
 1n(4ovcVSVKZ5+߄UCڿUC`"y:9FTLb6SpM^fM%,`K9GAj\>
wnG(.IEo4aa
Y0/-+ũ.;$i
z6e3񶔃י*hlr}#&94ּh!P9b~$']xĻ"VV_2ܸ
<e4(mIy|gF\$W*!1	CqBiۀw

zzCހjG$ZoC]c0O;s'E䱋ɇhx8P ozJܯ>'Pџ zyWȻV5઼բ:{
#Z1[?IJJ)g8SOoˌ*K~3ԁsܓgr0Q:E2{W F$^sފAhǬnI)z_sU? %.qq8tȵE/2Za R:Lzz70\Ȓ>F>
l`-lG1'ROE jEk5s MW4-`|Ag$an`z?{Ø*/.<Sv>OP}:!7uϓĄzc)~'HBG)yGc@h6>}0C%hCv$;J~'C^/ 4-ϳ:5bSer~)ʙacd
´-7a1E?BO䫝	R<q+	+m(}zroM4QX$=a[#?
?xcbg7wjU#	ÜIPl/p11w+oNz2ar@lKhW|%W?mKzY~b߽,xݵ{xE{i\glzB'H5X!d ^ (d~mi&%7NhA81!FY1bdV]	o|Z)U2ZqXxmqBhgx|י˔vc7E_mhބ͉ņ>%+σ.BY.Vu_oY^Lj1tjZ|i`a fL1Vw5	4
!	'q>?gh	!W0U/{;ϴàMou}[8AW쒼WSc/IzM끼]iz>vxx	kv5琍X+%[ǝ-Jx,L݂%U =a\GY.ĖٸmkƇNȦx4Pa2 KG~^J^`-kE՞kՕ~iKWCy u(FN>٦Cm2߲װ#<?co~ߔKC*dϮ.e<B#dzX)ѥ*+~̓pwfsU'ͲhS#N	mΨG44I\ݩudUmk^l`m^:#G+/wkd\ے$8=7Ds꼎o5FGծ*i1HɃao* h'/7y#Wxn$8(3RsHU$	,ֺ]n(`5o_"v{!rK{qn>7r;{ڻ*&h,`,È|5{<D0s+vq4L;$:0Gޒ;3g=qp2֣x+X/v_t7_#vrĊNHdo8>[!8qF%Ō|)}B*2RbG5r!)]m;TE.@yRMЗ:識^*|:Lr|c熝9b,A!^~_ʐђ~4{rNv5/#e\OǨxYn	uM>e;>?~!đIeɵwBx v*'CQG5IIQʜ1,u\: eErɑQ9)I}ӵҺAIyh7%Ɂ~'.~{FńeQyLOjUFPW .l=kجOXt TS#5h(W-
=R~rvfa<˄%gw1h;ٸj۟r8$ƬZ-:a9Z:y)h4ֺ]FhuxX;k5hvۍXQ)>\*G?SJA)pD;_n+gmoO:nm7kͻY_׫Vָ1<z}R+u1A
MGv</(%-g!
mLu>#FAFCÈ0a%I4"8/8DņApdq}~gZԫz%+p_x<Hb=/1@]m
LO,H8t<nkz%8
g9V1kJݵD)P3)Sd/+J'@݁KY29!j繑5=emүh'GG$h8Ӫj>'aϨ/Tngb=/!<¦B,E۫'RDRv̬1-74љ?pƸ0 !|tɁO}o8$=yAZu=o=|gv畯FA0&])ﷶUE@:])O"Jhh-bA%y帉BԬCf]<D^zL@fP^kzw1co]jgnw7+LZM3Mρ)LJ;~9&)5	)3Oa='
' k7x̭:8Sמ.*+$=[/{qq4goLj`{Gz
_'ݎb>3qYz*IIgn~{ޑWdѩ[M*cg^? ptJN@GIщm/md0Kg![Vu'o+vJEDk2`rq$:(pe5܌,Gk)~E0Kk]3YǚȺI2w&2{vSYQ7/;D]CV*O<p=]po6ootw6o,)7yo7o w6t>q=v/~}ONm]2xܱ@r P`pxH֏˝4;8g4
o"g1h:fRIDWZ6HFݫɁn{n3m]0)erȦɇg[wwtVuCLLp.&w\7SCA0J<Sd^@(}Vɗ@w}1K;*	w6X3MR9<o<nKJCt=ܫYPDw#/s5?{{ 	V[eyr{NJ~bޛ'*~b'|)_g?`??`o+b^#%{/_.Zϯ~|g&zO"r$\3/{l=ӚӊYI{W?ꭹ-֓{͆uΓ^md)1g{[{z"MlLOsW6̔f^on噦g]򟕛SjZe2~<:P2g(亶GQ|A=_KKV8WϷS]u._߰̔7p
`o7[yOc}3C/,xGmMGâAMC4`Pg_m<.@/P5XRCFҏ/ѧ!,	ԙ}-x].) sR/3g7i)^3uuvl|t?X2apX/2
ڏ8.-6\G݊
ֽT^
#䏵oR7G@ap
bAE,`^_ћqYDěHvd}X6^G-G	 Ps33SwZ7[{;)F=znkDM;FeFI*L?=ltPN3uVNٮzrvLk5ڡ·do3Sa~0Zc-w;4/~A[(59C.-bͨ!67!'tzq֚G5Va}PΜd|{&̫h24;w?nQ/ݶI%ۭջ^B=pW<I}7XtD!GκH'oʌNú@ndJx x|6&e/-FHJey(7f.s}v!/3JdWiw[woyt?a+W
1G#?U߼~Wū4H,Lڣ:O
UO*ig =|<7o$ p^Z4~P\V{=>.QFaQ}2
\E0?7q4d$=0k# y`xFQ%cS̃H6Ysu|QA[|ߏQɾ::ufa67#)ڻɖٲ	/7̗C4(MQ!WGIeN|Aݾn6_Ij{9hgf9:*&xR%ř񃏣ï0-#:
GFq#3/3duFu{@1LiGp[nunD otXb{X2 GWrhlJ(:[]m#o=+n-X~{7[	tVYmY:י\m 
#iՍ.[__Y]QuNiDl7ך@hgck}3D{;Z͵#@&|<@8\xa( I 8d[Vr`ziOЊMhCKGr'4176t%d׼l{UZjؓ&KFphgBRub}|au"K{'Q[ŸSAL	94~Ľ[ПȋAw2Yǅ&x`G̷4:@QbQ3 D>Z_B3_A5w 	rh,18}at=Fy ]	b:OS`MG03~uTq'zC8gx34bCgja0Sps8$[ɑR"k6Q_i`B/<BFҠNLRͬ_̏FH)PbSRd1jȓp|UI_i9(^¤]j!UT
ZwV?:pJNWS?Ȃ٠W}v5N:lw6Vݵ溨u[T59O[jOnL$_ݧպVkzs%mEV/?)mm](*je/z@g{}iH}
I
>ͦ^[qhHit͎9Ogo6[w5^gР* Z_5A, Ys{뢾pnry+:v]XsZjci7 ϖCU9)K_w:-Ż
5*5kZX`qAnkkCĢF_nwvmtNn85qֱ9Pffp(`Uh 
tkxCنnmJi ~WױMH耢묭/NwhhwjzQkutVFlpv6 ko
\B/[нX` Mx_iJz䠏uՁ~bw'7d(7*Tވֱ/@n/kʢ܁Ab-hkxJ,nt:Ј,6pymnUdvgۍ~_5]U7`6ZjWXw6Xl4Ӹ_8Z? 5Y\'MwƏx>kT@a^hj<?%I)wG>]z0UoFZ9Fz%O@`!1:oqc'5/z^{75>+N_j>?^R3qph|ؖ?sT"h5
'ڣ:W^PA+_!'\6nFƝ6QzI4̉yp1t
S#ʄ6Dū8 OQyԨ].
eѡ7<V(,?eэ<\A	C;z،}5sW:%͔
}_Y%J	n9Q)wKuKzyIK%y-{J.2uPy	edr:%s:N4^U8d!g`Т$ MQ"z%'C3X䩰zٜNƽ_e+C?_2W`0@͚w(#sG:Sg'[38a^nf\j^.Cq$ZZكӏ,1 i2~˪9;\
ƻ2e yEuI4.Z^{ 8Ō=ŕU=Q#Q0ϺiB=T+s+oݤ_V/T9 cdGvk]s>H۔kс)u5̪V!\!_Ɩ-XeE9Zن0G5	2μȘ0!
Ua86)-wiZZja)tsTaS⬏YW(iw֔It|E\7$Yr*՚(g}D|&!ɁYBUT[Fd4D%r0Ykh(iS,aJ2YK(=	oXu	TYǪ?UŅp^ qzPWkzF!96&/Ȇ)BGQJ/+79N5d.ęg-IRGK?Kjגz _&~of?F PIpb]6ϰ8@x~w6fC\C?˼.ۓ#$5Ȥﳮ
aM4 |4}EtEPRƶnƸBKb3<3 /h]Z1Q^mJXb >B/d	=ia`TR	ĵ;bFO Kt(}L3 ?A!	QW1JrK\ VVjZ1>Vv4EAW( #HɻpY6j|4Sj!@>g M}rqoeb$1Jǆ .e,/) tbhKӊ@Nn?{9/5RJ'jB;7	t^Y5j59	H}^{9y9a
WJ1&b728Qj3[u2	bnA1-: |}1'*_C/^0},.0VUpŪWܩ.yJq`Cl?)[oJe#ox|&0JY2"}W[e劭&"x+%+FE}%'"Lj(tɷ!<Eה<	&xhm1`֑ٙ8SNP$0w4U2E&J	H%od_dsJqm)H_tnä"n'lAfNͼS/za&GRMw0,î5\kb%ŵ8P`fY$:bΫM gw^0'͛[tj+5H7DMcv|al&,&2Atd-ytk1a}´RCͤ#$Cn/xps虳./sׄ\bz(PA3%//;OR0bAQwl\VkwDA;蓴OMAWlA;HAȀr`hܥ@m폿%lSk42eҷaƇ4Lf;UyЃ߫^?DRNǿ6䙆bOG~]ܾp8y+_ǣyΪ{jQ1htev~W,6f"*b@}! h1g\4;#A0$is| =&A:AC![@8q҅
P/ďÜcy9E
X=lOA;=-Tooo}1HSXTb#lo1>1dHWځK%NɮJNHVyv?׈h'"Gh'%l}VHO1a=<5" hm4C ÀOc'*TT&|麩4L;xt8slM$"[\y,#$
,:rSe_wyګFN`l.U/{ь7w4+V1}fA=>cGc]7ͯD$-TQϛ$guՀ۬d2@\1N`4Fj-F#IATd5>S4D`}mZE%ibh!$A&r	>Dć:ulY#EX`x'L(V^|^?`!S?#p1@|]˙2[2f4ʎ:h;(2h"̔x܇B<jP$4>#6k2`2F󽓃YԷ,!@܈q0}
Ih=#]\"Eݜ}3޸r66IIV?(-,!Qx<b&l1nitӎaK-
oW~xb9רeY
KV2jMHco̴v}L	4OEļ(sI Bk}UxP8QQߖ
f+zU,uku<0rRjĻ6[C˵:)-Y(Ew~M؉F=&mtSMe{0};e٤**B
(tdwgPFk!z80maOUdʎA#yjĲ̍z]7V	x!Aē.Cnxx4	d!qf_߮jZYHrF?	yI3|(@dFbgC'~zq.7= &!{3%'pgQ+	y#6w_)K;lm1jdtS?`tIϲf>q60l{~yVbM쌻o6é\uHZ_ wI`.?ay?Փk5Y{}.6Vgdf]x f:n1_0?.}7f!Ŧb8HAT,d|n	srXFǔ|>m@K|&ZihaDՋ,`fB'nGǨ☄V}RcA߁>ra T
w!]p'LooSuc|O>E?F}!c`㰬kHpNU:J|tU wPnhhB->Jz>qf2FuIYU jrۖ48PӜ qM!DcC3w~U8;g%ǜڶɏxApE%k<4|ȯn_kqw6i}V# H79
7<~PD=;!qgQm+aiue eAp }+{?X=@X%s9}y3nՈAd;AlF/m?kx@ŅA!D#g4CQz@?X|D\8\k]"u:m<3yD+C4GcВԧd{Q>Y8)\]Cl,88+*g3QeQ%fNk5[-aňD\Wc' evfOd\Y=U$gQoy@e,ꖵYX`fYd[q0F'
lbf]S eӌrAZti-ƝWLUEyuLMϡc%х/_0034fZuV!Ak5:q~z?o~2XÄ<:tIz0JzJrX孽KȘ[to/M!cv(ךջ۾Cj{@{\A*UE\TBc+P
84N?I28nܐ	JE;LujG0*bu ,xOdJ| ƀրRӇxv&H݁J&ILB "q]1UN.bHCHԆUAEx\bq~/^xx_.#
+K࿌_i(>Wwxc7|i4|\HlЂD]Axnu9K88Q,'Kti2I!9dI sxt1ev2	1bC?MY%@7ƋQky)[ʢtQ;Jf+(1 "G#!(,	Rٜg⧀?d}Y4\kԒxK6ȠH+嬗ozf6cWcORo䫝<O&~/"Y2&9M>[L23
~ph	][XFX䠿aY|l"x	d x
B֝O7ox8'|w /@n(iGN2 V0އAL؆fJxf}@W+ {?m#KQG>п"?DЯB@{5Lkf-`8 /a+mgnԑd5tQ6#)>`Q *v)	@!rA"RKCdm@JGω
8)p,Ax!]<ؠCNP dD:\<@z5n)٣~2}iei+q_z1Zm5woK+X*'s!q&FPjy4@EGK{wA N 